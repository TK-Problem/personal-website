<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomas Kristijonas Uždavinys">
<meta name="dcterms.date" content="2023-04-08">

<title>Tomas Kristijonas Uždavinys - One-Sample Binomial Test (Part 1)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>
<script src="../../site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="../../site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tomas Kristijonas Uždavinys</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">One-Sample Binomial Test (Part 1)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tomas Kristijonas Uždavinys </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">April 8, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The binomial test is a statistical test used to determine whether the proportion of cases in one of only two categories is equivalent to a pre-specified proportion. Categories could include the default rate of clients within the next 12 months, patients with high or low risk of heart disease, potential customers who are likely or not likely to make a purchase, or the rate of manufacturing defects. This widely used test finds applications in diverse fields, including credit risk, medicine, and manufacturing. It is also known to as the <strong>one-sample proportion test</strong> or <strong>test of one proportion</strong>.</p>
<p>As with all statistical tests, the binomial test has assumptions and conditions that must be met before applying it to real-life data:</p>
<ul>
<li>The “success-failure” condition requires observing a minimum of <strong>n</strong> successes and <strong>n</strong> failures in the sample;</li>
<li>observations are independent, i.e.&nbsp;the occurrence of one event does not affect the probability of occurrence of the other.</li>
</ul>
<p>The aim of this blog post is to showcase the ramifications of failing to meet “success-failure” condition critereon. Practical examples are coded in both <code>R</code> and <code>Python</code> languages.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries for blog post</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set style</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"ggplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="theory" class="level2">
<h2 class="anchored" data-anchor-id="theory">Theory</h2>
<p>Suppose that we have a sample where outcomes are binary - e.g.&nbsp;only “success” and “failure”. For the given sample, we would like to estimate the true proportion and also set up a statistical test to verify whether if the proportion is equal to some value, e.g.&nbsp;expected.</p>
<p>First, we calculate a point estimate:</p>
<p><span class="math display">\[p = \frac{n_s}{n}\]</span></p>
<p>, where <span class="math inline">\(n\)</span> - sample size and <span class="math inline">\(n_s\)</span> - the number of successful observations (or it can be the number of failures).</p>
<p><span class="math display">\[SE = \sqrt{\frac{p \cdot (1 - p)}{n}}\]</span> , where <span class="math inline">\(SE\)</span> is standard error. To perform a test, one first needs to derive a Null hypothesis:</p>
<p><span class="math display">\[H_0: p = p_0\]</span></p>
<p>and an alternative hypothesis:</p>
<ul>
<li>one-sided <span class="math inline">\(H_A: p &lt; p_0\)</span> or <span class="math inline">\(H_A: p &gt; p_0\)</span>,</li>
<li>two-sided <span class="math inline">\(H_A: p \ne p_0\)</span>.</li>
</ul>
<p>Finally, we needs to calculate <span class="math inline">\(Z\)</span> statistics:</p>
<p><span class="math display">\[Z = \frac{p_0-p}{SE}\]</span></p>
<p>Obtaining the value of <span class="math inline">\(Z\)</span> enables us to either compute confidence intervals (<span class="math inline">\(CI\)</span>) or reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span></p>
</section>
<section id="success-failure-condition" class="level2">
<h2 class="anchored" data-anchor-id="success-failure-condition">“Success-failure” condition</h2>
<p>To approximate any distribution as normal, it is imperative to calculate the mean (<span class="math inline">\(\mu\)</span>) and standard deviation (<span class="math inline">\(\sigma\)</span>). For the Binomial distribution, which consists of a number of experiments <span class="math inline">\(n\)</span> and a probability <span class="math inline">\(p\)</span>, the mean of the normal distribution is:</p>
<p><span class="math display">\[\mu = n \cdot p\]</span></p>
<p>and the standard deviation:</p>
<p><span class="math display">\[\sigma = \sqrt{n \cdot p \cdot (1 - p)}.\]</span></p>
<p>Meeting the “Success-Failure” condition is crucial to approximate Binomial distribution as Normal. Below, I present an instance of 50 Binomial events with varying probability rates of 5%, 30%, and 90%. In tabs <code>binomial vs normal</code> binomial distributions are plotted against it’s normal distribution approximation.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">binomial vs.&nbsp;normal (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">error (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">binomial vs.&nbsp;normal (Python)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">error (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">CJ</span>(p, x)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add size column</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>dt[, size <span class="sc">:</span><span class="er">=</span> <span class="dv">50</span>]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add binomial probability</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>dt[, Binomial <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create label column</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">"Prob: "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"%, exp. successes "</span>, <span class="fu">round</span>(p<span class="sc">*</span>size),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" exp. failures "</span>, <span class="fu">round</span>((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>size))]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> size <span class="sc">*</span> p]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>dt[, st.dev <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> size)]</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>dt[, Normal <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>mu, <span class="at">sd =</span> st.dev) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to ordered factor</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(label, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Prob: 5%, exp. successes 2 exp. failures 48"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 30%, exp. successes 15 exp. failures 35"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 90%, exp. successes 45 exp. failures 5"</span> ))]</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape for plotting</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>dt.plot <span class="ot">&lt;-</span> <span class="fu">melt</span>(dt, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"label"</span>),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"Binomial"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="fu">c</span>(<span class="st">"Type"</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="fu">c</span>(<span class="st">'prob'</span>))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt.plot, <span class="fu">aes</span>(x, prob, <span class="at">color=</span>Type)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Probability, %"</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use data.table from previous code chunk)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dt[, Error <span class="sc">:</span><span class="er">=</span> Binomial <span class="sc">-</span> Normal]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(x, Error)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Error (binom. - norm.), %"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">51</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create DataFrame with all combinations</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> pd.DataFrame({<span class="st">'p'</span>: p})</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df_2 <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x})</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create key for joining</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_1[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df_2[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># perform cross join</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_1.merge(df_2, on<span class="op">=</span><span class="st">'key'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># drop key column</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> df[<span class="st">'key'</span>]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add size value</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate binomial probability</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Binomial'</span>] <span class="op">=</span> binom.pmf(df[<span class="st">'x'</span>], df[<span class="st">'size'</span>], df[<span class="st">'p'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mu'</span>] <span class="op">=</span> df[<span class="st">'size'</span>] <span class="op">*</span> df[<span class="st">'p'</span>]</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'se'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">/</span> df[<span class="st">'size'</span>])</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'std'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">*</span> df[<span class="st">'size'</span>])</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Normal'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: norm.pdf(x[<span class="st">'x'</span>], x[<span class="st">'mu'</span>], x[<span class="st">'std'</span>]) <span class="op">*</span> <span class="dv">100</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p].copy()</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Binomial'</span>], <span class="st">"o"</span>, label<span class="op">=</span><span class="st">'Binomial'</span>)<span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Normal'</span>], <span class="st">"-"</span>, label<span class="op">=</span><span class="st">'Normal'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)<span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend and white background</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>legend <span class="op">=</span> ax[<span class="dv">1</span>].legend(frameon <span class="op">=</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> legend.get_frame()<span class="op">;</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>frame.set_color(<span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use DataFrame from previous code chunk)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Error'</span>] <span class="op">=</span> df.Binomial <span class="op">-</span> df.Normal</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Error'</span>], <span class="st">"o"</span>, color<span class="op">=</span><span class="st">'k'</span>, markersize<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust limits for better readability</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">4.9</span>, <span class="fl">4.9</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(-4.9, 4.9)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The first thing to notice is that the “Success-Failure” criterion is only met for the p=30% case. In tabs <code>error</code> one can see that approximation error, i.e.&nbsp;the difference between probabilities calculated using Binomial and Normal distribution approximations, is above 2% for the <span class="math inline">\(p=5\%\)</span> and <span class="math inline">\(p=90\%\)</span> examples.</p>
</section>
<section id="estimating-approximation-error" class="level2">
<h2 class="anchored" data-anchor-id="estimating-approximation-error">Estimating approximation error</h2>
<p>Let’s dive deeper into understanding approximation error. We have to be mindful, when comparing discrete binomial distribution with a continuous normal distribution. The binomial distribution probability spaces bounded between 0 and <code>k</code> events, where <code>k</code> number of attempts while for normal it’s mathematical y unbounded (for large <code>Z</code> values you can calculate very small probability values). Apart for case <span class="math inline">\(p=50\%\)</span> binomial distribution is not symmetrical as oppose to normal distribution. In examples bellow, we will compare areas under the curve for both distributions using interactive charts by <code>plotly</code> library/package. First I have created a functions which visualizes both distributions using interactive charts.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">plot_ly function (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">plotly function (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>PlotDistributions <span class="ot">&lt;-</span> <span class="cf">function</span>(prob, size){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (prob <span class="sc">&lt;</span> <span class="fl">0.5</span>){</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(size<span class="sc">*</span>prob<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> (size <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> size <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob))<span class="sc">:</span>size</span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>prob) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>size <span class="sc">*</span> prob, <span class="at">sd =</span> <span class="fu">sqrt</span>(prob <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob) <span class="sc">*</span> size)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data table for plotting</span></span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x,</span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.binom =</span> y.binom,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.norm =</span> y.norm)</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns with hover information</span></span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate error&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom <span class="sc">-</span> y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>(prob.binom<span class="sc">-</span>prob.norm), <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                           <span class="at">visible =</span> <span class="st">"legendonly"</span>) </span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(prob<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, size, <span class="st">" trials"</span>),</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb9-49"><a href="#cb9-49" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb9-50"><a href="#cb9-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure</span></span>
<span id="cb9-51"><a href="#cb9-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb9-52"><a href="#cb9-52" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create function for plotting distributions</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_distributions(prob, size):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> np.arange(<span class="bu">int</span>(size<span class="op">*</span>prob<span class="op">*</span><span class="dv">3</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  y_binom <span class="op">=</span> binom.pmf(x, n<span class="op">=</span>size, p<span class="op">=</span>prob) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate variance and sigma</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  variance <span class="op">=</span> size <span class="op">*</span> prob <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> prob)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> np.sqrt(variance)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  y_norm <span class="op">=</span> norm.pdf(x, loc <span class="op">=</span> size <span class="op">*</span> prob, scale <span class="op">=</span> sigma) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate Data.Frame</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'binom'</span>: y_binom, <span class="st">'norm'</span>: y_norm})</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'error'</span>] <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  error <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate hover messages</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_1'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"binom"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_2'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"norm"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_3'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate error&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"error"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_norm, text <span class="op">=</span> df[<span class="st">'text_1'</span>].values,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Normal'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                           line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FF6666'</span>, width<span class="op">=</span><span class="dv">5</span>)))</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_binom, text <span class="op">=</span> df[<span class="st">'text_2'</span>].values,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Binomial'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#3399FF'</span>, size<span class="op">=</span><span class="dv">12</span>)))</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>error, text <span class="op">=</span> df[<span class="st">'text_3'</span>].values,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Error'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                           visible <span class="op">=</span> <span class="st">"legendonly"</span>))</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit the layout</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  fig.update_layout(title<span class="op">=</span><span class="ss">f"p = </span><span class="sc">{</span>prob<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%, </span><span class="sc">{</span>size<span class="sc">}</span><span class="ss"> trials"</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>                    xaxis_title<span class="op">=</span><span class="st">'Observations'</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                    yaxis_title<span class="op">=</span><span class="st">'Probability, %'</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                    template<span class="op">=</span><span class="st">"ggplot2"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                    hovermode<span class="op">=</span><span class="st">"x unified"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Next I provide examples using small probabilities (99%, 95%, 0.5% and 0.1%) where “Success-failure” condition is not met, i.e.&nbsp;either 5 failures or 5 successes are expected for all 4 examples.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">99.9% (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">99.5% (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">0.5% (Python)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">0.01% (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.999</span>, <span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-79267c5743af77ccf555" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-79267c5743af77ccf555">{"x":{"visdat":{"3c4023abad6":["function () ","plotlyVisDat"]},"cur_data":"3c4023abad6","attrs":{"3c4023abad6":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c4023abad6.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c4023abad6.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c4023abad6.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"visible":"legendonly","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 100%, 5000 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[4985,4986,4987,4988,4989,4990,4991,4992,4993,4994,4995,4996,4997,4998,4999,5000],"y":[0.000802324784976518,0.00537447082286576,0.029469676496598,0.132272385216317,0.485978615601124,1.46156889477757,3.59811949013648,7.25080172732662,11.960535793812,16.1498836713939,17.8501684781542,16.1498836713939,11.960535793812,7.25080172732662,3.59811949013648,1.46156889477757],"text":["Point estimate probability<br>to observer exactly 4985 events is 0.016%","Point estimate probability<br>to observer exactly 4986 events is 0.047%","Point estimate probability<br>to observer exactly 4987 events is 0.131%","Point estimate probability<br>to observer exactly 4988 events is 0.342%","Point estimate probability<br>to observer exactly 4989 events is 0.822%","Point estimate probability<br>to observer exactly 4990 events is 1.811%","Point estimate probability<br>to observer exactly 4991 events is 3.624%","Point estimate probability<br>to observer exactly 4992 events is 6.527%","Point estimate probability<br>to observer exactly 4993 events is 10.448%","Point estimate probability<br>to observer exactly 4994 events is 14.63%","Point estimate probability<br>to observer exactly 4995 events is 17.556%","Point estimate probability<br>to observer exactly 4996 events is 17.552%","Point estimate probability<br>to observer exactly 4997 events is 14.036%","Point estimate probability<br>to observer exactly 4998 events is 8.417%","Point estimate probability<br>to observer exactly 4999 events is 3.364%","Point estimate probability<br>to observer exactly 5000 events is 0.672%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[4985,4986,4987,4988,4989,4990,4991,4992,4993,4994,4995,4996,4997,4998,4999,5000],"y":[0.0155912253006416,0.0468581049197982,0.131413165311469,0.34215372451886,0.822156514237738,1.81055670039247,3.6240155153117,6.52714813665208,10.447620249975,14.6295971982528,17.5555166379031,17.5520027234437,14.0359821658754,8.41653432395608,3.36391989983281,0.672111195986559],"text":["Point estimate probability<br>to observer exactly 4985 events is 0.001%","Point estimate probability<br>to observer exactly 4986 events is 0.005%","Point estimate probability<br>to observer exactly 4987 events is 0.029%","Point estimate probability<br>to observer exactly 4988 events is 0.132%","Point estimate probability<br>to observer exactly 4989 events is 0.486%","Point estimate probability<br>to observer exactly 4990 events is 1.462%","Point estimate probability<br>to observer exactly 4991 events is 3.598%","Point estimate probability<br>to observer exactly 4992 events is 7.251%","Point estimate probability<br>to observer exactly 4993 events is 11.961%","Point estimate probability<br>to observer exactly 4994 events is 16.15%","Point estimate probability<br>to observer exactly 4995 events is 17.85%","Point estimate probability<br>to observer exactly 4996 events is 16.15%","Point estimate probability<br>to observer exactly 4997 events is 11.961%","Point estimate probability<br>to observer exactly 4998 events is 7.251%","Point estimate probability<br>to observer exactly 4999 events is 3.598%","Point estimate probability<br>to observer exactly 5000 events is 1.462%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[4985,4986,4987,4988,4989,4990,4991,4992,4993,4994,4995,4996,4997,4998,4999,5000],"y":[0.0147889005156651,0.0414836340969325,0.101943488814871,0.209881339302543,0.336177898636614,0.348987805614906,0.0258960251752205,-0.72365359067454,-1.51291554383703,-1.52028647314116,-0.294651840251035,1.40211905204981,2.07544637206344,1.16573259662945,-0.234199590303664,-0.789457698791009],"text":["Point estimate error<br>to observer exactly 4985 events is 0.015%","Point estimate error<br>to observer exactly 4986 events is 0.041%","Point estimate error<br>to observer exactly 4987 events is 0.102%","Point estimate error<br>to observer exactly 4988 events is 0.21%","Point estimate error<br>to observer exactly 4989 events is 0.336%","Point estimate error<br>to observer exactly 4990 events is 0.349%","Point estimate error<br>to observer exactly 4991 events is 0.026%","Point estimate error<br>to observer exactly 4992 events is -0.724%","Point estimate error<br>to observer exactly 4993 events is -1.513%","Point estimate error<br>to observer exactly 4994 events is -1.52%","Point estimate error<br>to observer exactly 4995 events is -0.295%","Point estimate error<br>to observer exactly 4996 events is 1.402%","Point estimate error<br>to observer exactly 4997 events is 2.075%","Point estimate error<br>to observer exactly 4998 events is 1.166%","Point estimate error<br>to observer exactly 4999 events is -0.234%","Point estimate error<br>to observer exactly 5000 events is -0.789%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"visible":"legendonly","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.995</span>, <span class="dv">1000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-5eba1600142fded62d26" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-5eba1600142fded62d26">{"x":{"visdat":{"3c4010b158ee":["function () ","plotlyVisDat"]},"cur_data":"3c4010b158ee","attrs":{"3c4010b158ee":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c4010b158ee.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c4010b158ee.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c4010b158ee.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"visible":"legendonly","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 100%, 1000 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.000772226784477017,0.00521255807668199,0.0287780643505277,0.129950178004968,0.479950893854638,1.44984427397707,3.58220583778748,7.23909612805625,11.9652775417621,16.1758025349048,17.8860122260537,16.1758025349048,11.9652775417621,7.23909612805625,3.58220583778748,1.44984427397707],"text":["Point estimate probability<br>to observer exactly 985 events is 0.015%","Point estimate probability<br>to observer exactly 986 events is 0.046%","Point estimate probability<br>to observer exactly 987 events is 0.129%","Point estimate probability<br>to observer exactly 988 events is 0.337%","Point estimate probability<br>to observer exactly 989 events is 0.814%","Point estimate probability<br>to observer exactly 990 events is 1.8%","Point estimate probability<br>to observer exactly 991 events is 3.614%","Point estimate probability<br>to observer exactly 992 events is 6.524%","Point estimate probability<br>to observer exactly 993 events is 10.46%","Point estimate probability<br>to observer exactly 994 events is 14.659%","Point estimate probability<br>to observer exactly 995 events is 17.591%","Point estimate probability<br>to observer exactly 996 events is 17.573%","Point estimate probability<br>to observer exactly 997 events is 14.03%","Point estimate probability<br>to observer exactly 998 events is 8.393%","Point estimate probability<br>to observer exactly 999 events is 3.344%","Point estimate probability<br>to observer exactly 1000 events is 0.665%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.0150647543164776,0.0456067866477543,0.128734050253945,0.33707994737546,0.813899812267541,1.79962291823601,3.61377356941438,6.52446417623099,10.4601681455788,14.6589680350012,17.5907616420015,17.5731002347304,14.0302786227135,8.39286206188372,3.34370280343315,0.665396857883196],"text":["Point estimate probability<br>to observer exactly 985 events is 0.001%","Point estimate probability<br>to observer exactly 986 events is 0.005%","Point estimate probability<br>to observer exactly 987 events is 0.029%","Point estimate probability<br>to observer exactly 988 events is 0.13%","Point estimate probability<br>to observer exactly 989 events is 0.48%","Point estimate probability<br>to observer exactly 990 events is 1.45%","Point estimate probability<br>to observer exactly 991 events is 3.582%","Point estimate probability<br>to observer exactly 992 events is 7.239%","Point estimate probability<br>to observer exactly 993 events is 11.965%","Point estimate probability<br>to observer exactly 994 events is 16.176%","Point estimate probability<br>to observer exactly 995 events is 17.886%","Point estimate probability<br>to observer exactly 996 events is 16.176%","Point estimate probability<br>to observer exactly 997 events is 11.965%","Point estimate probability<br>to observer exactly 998 events is 7.239%","Point estimate probability<br>to observer exactly 999 events is 3.582%","Point estimate probability<br>to observer exactly 1000 events is 1.45%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[985,986,987,988,989,990,991,992,993,994,995,996,997,998,999,1000],"y":[0.0142925275320006,0.0403942285710723,0.0999559859034168,0.207129769370492,0.333948918412903,0.349778644258937,0.0315677316268963,-0.714631951825259,-1.50510939618337,-1.51683449990355,-0.295250584052255,1.39729769982556,2.06500108095136,1.15376593382747,-0.23850303435433,-0.784447416093872],"text":["Point estimate error<br>to observer exactly 985 events is 0.014%","Point estimate error<br>to observer exactly 986 events is 0.04%","Point estimate error<br>to observer exactly 987 events is 0.1%","Point estimate error<br>to observer exactly 988 events is 0.207%","Point estimate error<br>to observer exactly 989 events is 0.334%","Point estimate error<br>to observer exactly 990 events is 0.35%","Point estimate error<br>to observer exactly 991 events is 0.032%","Point estimate error<br>to observer exactly 992 events is -0.715%","Point estimate error<br>to observer exactly 993 events is -1.505%","Point estimate error<br>to observer exactly 994 events is -1.517%","Point estimate error<br>to observer exactly 995 events is -0.295%","Point estimate error<br>to observer exactly 996 events is 1.397%","Point estimate error<br>to observer exactly 997 events is 2.065%","Point estimate error<br>to observer exactly 998 events is 1.154%","Point estimate error<br>to observer exactly 999 events is -0.239%","Point estimate error<br>to observer exactly 1000 events is -0.784%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"visible":"legendonly","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.005</span>, <span class="dv">1000</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>                <div id="62938297-8a69-461d-b581-ecbf9384a8a4" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("62938297-8a69-461d-b581-ecbf9384a8a4")) {                    Plotly.newPlot(                        "62938297-8a69-461d-b581-ecbf9384a8a4",                        [{"hoverinfo":"text","line":{"color":"#FF6666","width":5},"mode":"lines","name":"Normal","text":["Point estimate probability<br>to observer exactly 0 events is 0.665%","Point estimate probability<br>to observer exactly 1 events is 3.344%","Point estimate probability<br>to observer exactly 2 events is 8.393%","Point estimate probability<br>to observer exactly 3 events is 14.030%","Point estimate probability<br>to observer exactly 4 events is 17.573%","Point estimate probability<br>to observer exactly 5 events is 17.591%","Point estimate probability<br>to observer exactly 6 events is 14.659%","Point estimate probability<br>to observer exactly 7 events is 10.460%","Point estimate probability<br>to observer exactly 8 events is 6.524%","Point estimate probability<br>to observer exactly 9 events is 3.614%","Point estimate probability<br>to observer exactly 10 events is 1.800%","Point estimate probability<br>to observer exactly 11 events is 0.814%","Point estimate probability<br>to observer exactly 12 events is 0.337%","Point estimate probability<br>to observer exactly 13 events is 0.129%","Point estimate probability<br>to observer exactly 14 events is 0.046%"],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[1.4498442739770656,3.582205837787477,7.239096128056248,11.965277541762143,16.17580253490479,17.886012226053726,16.17580253490479,11.965277541762143,7.239096128056248,3.582205837787477,1.4498442739770656,0.4799508938546375,0.12995017800496791,0.028778064350527616,0.0052125580766819585],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"#3399FF","size":12},"mode":"markers","name":"Binomial","text":["Point estimate probability<br>to observer exactly 0 events is 1.450%","Point estimate probability<br>to observer exactly 1 events is 3.582%","Point estimate probability<br>to observer exactly 2 events is 7.239%","Point estimate probability<br>to observer exactly 3 events is 11.965%","Point estimate probability<br>to observer exactly 4 events is 16.176%","Point estimate probability<br>to observer exactly 5 events is 17.886%","Point estimate probability<br>to observer exactly 6 events is 16.176%","Point estimate probability<br>to observer exactly 7 events is 11.965%","Point estimate probability<br>to observer exactly 8 events is 7.239%","Point estimate probability<br>to observer exactly 9 events is 3.582%","Point estimate probability<br>to observer exactly 10 events is 1.450%","Point estimate probability<br>to observer exactly 11 events is 0.480%","Point estimate probability<br>to observer exactly 12 events is 0.130%","Point estimate probability<br>to observer exactly 13 events is 0.029%","Point estimate probability<br>to observer exactly 14 events is 0.005%"],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[0.6653968578831966,3.3437028034331644,8.392862061883735,14.03027862271351,17.573100234730372,17.590761642001468,14.658968035001207,10.460168145578756,6.524464176230972,3.613773569414358,1.799622918235998,0.813899812267538,0.33707994737545754,0.1287340502539433,0.04560678664775393],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"black","size":12},"mode":"markers","name":"Error","text":["Point estimate error<br>to observer exactly 0 events is -0.784%","Point estimate error<br>to observer exactly 1 events is -0.239%","Point estimate error<br>to observer exactly 2 events is 1.154%","Point estimate error<br>to observer exactly 3 events is 2.065%","Point estimate error<br>to observer exactly 4 events is 1.397%","Point estimate error<br>to observer exactly 5 events is -0.295%","Point estimate error<br>to observer exactly 6 events is -1.517%","Point estimate error<br>to observer exactly 7 events is -1.505%","Point estimate error<br>to observer exactly 8 events is -0.715%","Point estimate error<br>to observer exactly 9 events is 0.032%","Point estimate error<br>to observer exactly 10 events is 0.350%","Point estimate error<br>to observer exactly 11 events is 0.334%","Point estimate error<br>to observer exactly 12 events is 0.207%","Point estimate error<br>to observer exactly 13 events is 0.100%","Point estimate error<br>to observer exactly 14 events is 0.040%"],"visible":"legendonly","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[-0.784447416093869,-0.23850303435431242,1.1537659338274864,2.065001080951367,1.3972976998255824,-0.29525058405225835,-1.5168344999035828,-1.5051093961833875,-0.7146319518252762,0.0315677316268812,0.34977864425893235,0.33394891841290053,0.20712976937048963,0.09995598590341569,0.04039422857107197],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"p = 0.5%, 1000 trials"},"xaxis":{"title":{"text":"Observations"}},"yaxis":{"title":{"text":"Probability, %"}},"hovermode":"x unified"},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.001</span>, <span class="dv">5000</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>                <div id="16e87eb8-905f-4563-b072-76fafeaaf85b" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("16e87eb8-905f-4563-b072-76fafeaaf85b")) {                    Plotly.newPlot(                        "16e87eb8-905f-4563-b072-76fafeaaf85b",                        [{"hoverinfo":"text","line":{"color":"#FF6666","width":5},"mode":"lines","name":"Normal","text":["Point estimate probability<br>to observer exactly 0 events is 0.672%","Point estimate probability<br>to observer exactly 1 events is 3.364%","Point estimate probability<br>to observer exactly 2 events is 8.417%","Point estimate probability<br>to observer exactly 3 events is 14.036%","Point estimate probability<br>to observer exactly 4 events is 17.552%","Point estimate probability<br>to observer exactly 5 events is 17.556%","Point estimate probability<br>to observer exactly 6 events is 14.630%","Point estimate probability<br>to observer exactly 7 events is 10.448%","Point estimate probability<br>to observer exactly 8 events is 6.527%","Point estimate probability<br>to observer exactly 9 events is 3.624%","Point estimate probability<br>to observer exactly 10 events is 1.811%","Point estimate probability<br>to observer exactly 11 events is 0.822%","Point estimate probability<br>to observer exactly 12 events is 0.342%","Point estimate probability<br>to observer exactly 13 events is 0.131%","Point estimate probability<br>to observer exactly 14 events is 0.047%"],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[1.461568894777565,3.5981194901364755,7.250801727326624,11.960535793811983,16.149883671393933,17.85016847815418,16.149883671393933,11.960535793811983,7.250801727326624,3.5981194901364755,1.461568894777565,0.4859786156011229,0.13227238521631626,0.029469676496597843,0.005374470822865725],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"#3399FF","size":12},"mode":"markers","name":"Binomial","text":["Point estimate probability<br>to observer exactly 0 events is 1.462%","Point estimate probability<br>to observer exactly 1 events is 3.598%","Point estimate probability<br>to observer exactly 2 events is 7.251%","Point estimate probability<br>to observer exactly 3 events is 11.961%","Point estimate probability<br>to observer exactly 4 events is 16.150%","Point estimate probability<br>to observer exactly 5 events is 17.850%","Point estimate probability<br>to observer exactly 6 events is 16.150%","Point estimate probability<br>to observer exactly 7 events is 11.961%","Point estimate probability<br>to observer exactly 8 events is 7.251%","Point estimate probability<br>to observer exactly 9 events is 3.598%","Point estimate probability<br>to observer exactly 10 events is 1.462%","Point estimate probability<br>to observer exactly 11 events is 0.486%","Point estimate probability<br>to observer exactly 12 events is 0.132%","Point estimate probability<br>to observer exactly 13 events is 0.029%","Point estimate probability<br>to observer exactly 14 events is 0.005%"],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[0.6721111959865588,3.3639198998326387,8.416534323955638,14.035982165875968,17.55200272344401,17.555516637903175,14.629597198252627,10.447620249974785,6.527148136652163,3.6240155153117133,1.810556700392469,0.822156514237731,0.34215372451885484,0.13141316531146913,0.04685810491979793],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"black","size":12},"mode":"markers","name":"Error","text":["Point estimate error<br>to observer exactly 0 events is -0.789%","Point estimate error<br>to observer exactly 1 events is -0.234%","Point estimate error<br>to observer exactly 2 events is 1.166%","Point estimate error<br>to observer exactly 3 events is 2.075%","Point estimate error<br>to observer exactly 4 events is 1.402%","Point estimate error<br>to observer exactly 5 events is -0.295%","Point estimate error<br>to observer exactly 6 events is -1.520%","Point estimate error<br>to observer exactly 7 events is -1.513%","Point estimate error<br>to observer exactly 8 events is -0.724%","Point estimate error<br>to observer exactly 9 events is 0.026%","Point estimate error<br>to observer exactly 10 events is 0.349%","Point estimate error<br>to observer exactly 11 events is 0.336%","Point estimate error<br>to observer exactly 12 events is 0.210%","Point estimate error<br>to observer exactly 13 events is 0.102%","Point estimate error<br>to observer exactly 14 events is 0.041%"],"visible":"legendonly","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14],"y":[-0.7894576987910061,-0.23419959030383675,1.165732596629014,2.0754463720639844,1.4021190520500753,-0.29465184025100655,-1.5202864731413062,-1.5129155438371988,-0.723653590674461,0.025896025175237813,0.34898780561490406,0.3361778986366081,0.20988133930253858,0.10194348881487128,0.041483634096932204],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"p = 0.1%, 5000 trials"},"xaxis":{"title":{"text":"Observations"}},"yaxis":{"title":{"text":"Probability, %"}},"hovermode":"x unified"},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
</div>
</div>
<p>Let’s taken hypothetical model with small probability, i.e.&nbsp;we expect to have 1% manufacturing defects or 1% of clients in our portfolio will fail to meet their credit obligations. For this hypothetical model to meet “Success-Failure” condition we would need to collect at least 1000 observations, i.e.&nbsp;to manufacture 1000 devices or issue credit to 1000 obligatory. In the tab <code>1% (R)</code> that if this condition is not met, i.e.&nbsp;we collected 500 events and expect 5 failures/defaults. From both visual inspection and reviewing error estimates for different outcomes (select <code>error</code> on legend to view error values) it’s clear that normal distribution approximation overestimates probability for <span class="math inline">\(\ge5\)</span> and underestimates <span class="math inline">\(\le5\)</span>. For all 4 examples, expected number of “Successes-failures” is 5. One can observed that the smaller the probability is the larger the error becomes.</p>
<p>Let’s compare 3 probabilities calculated using binomial and normal distribution approximation:</p>
<ul>
<li><span class="math inline">\(p_1\)</span> we would observe more than expected number of occurrences,</li>
<li><span class="math inline">\(p_2\)</span> we would observe expected number of occurrences,</li>
<li><span class="math inline">\(p_3\)</span> we would observe less than expected number of occurrences.</li>
</ul>
<p>We can calculate these probabilities using both binomial and normal distributions and then compare them, e.g.&nbsp;<span class="math inline">\(ratio_1 = \frac{p_1 (binom.)}{p_1 (norm.)}\)</span>. <span class="math inline">\(p_1\)</span> probabilities and all 3 ratios are calculated for all 4 examples above and few more examples. For all cases we have 5 expected successes or failures. Results are presented in table bellow.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data.table</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.999</span>, <span class="fl">0.995</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.8</span>,</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.5</span>,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.2</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">0.001</span>),</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>                 <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">1000</span>, <span class="dv">500</span>, <span class="dv">100</span>, <span class="dv">25</span>,</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">10</span>,</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">5000</span>))</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="co"># expected events</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>dt[, x <span class="sc">:</span><span class="er">=</span> p <span class="sc">*</span> N]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># get binomial, normal probabilities and their ratio</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>dt[, binom.p1 <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>dt[, norm.p1 <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> binom.p1<span class="sc">/</span>norm.p1 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p2 probabilities</span></span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>dt[, binom.p2 <span class="sc">:</span><span class="er">=</span> <span class="fu">pbinom</span>(x<span class="dv">-1</span>, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a>dt[, norm.p2 <span class="sc">:</span><span class="er">=</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">dnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p3 probabilities</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>dt[, binom.p3 <span class="sc">:</span><span class="er">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p)) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate ratios</span></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> binom.p2<span class="sc">/</span>norm.p2 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> binom.p3<span class="sc">/</span>norm.p2 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co"># round columns for better readability</span></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">names</span>(dt)[<span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>dt[,(cols) <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(.SD, <span class="dv">3</span>), .SDcols<span class="ot">=</span>cols]</span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co"># convert probability to percents</span></span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>dt[, p <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(p <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)]</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co"># remove column</span></span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table with first few rows and columns</span></span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(dt[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">10</span>)], <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"p, %"</span>, <span class="st">"N"</span>, <span class="st">"p_1 (binom.), %"</span>, <span class="st">"p_1 (norm.), %"</span>, <span class="st">"ratio_1"</span>, <span class="st">"ratio_2"</span>, <span class="st">"ratio_3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<table class="table table-striped table-hover table-condensed" style="margin-left: auto; margin-right: auto;">
 <thead>
  <tr>
   <th style="text-align:right;"> p, % </th>
   <th style="text-align:right;"> N </th>
   <th style="text-align:right;"> p_1 (binom.), % </th>
   <th style="text-align:right;"> p_1 (norm.), % </th>
   <th style="text-align:right;"> ratio_1 </th>
   <th style="text-align:right;"> ratio_2 </th>
   <th style="text-align:right;"> ratio_3 </th>
  </tr>
 </thead>
<tbody>
  <tr>
   <td style="text-align:right;"> 99.9 </td>
   <td style="text-align:right;"> 5000 </td>
   <td style="text-align:right;"> 17.556 </td>
   <td style="text-align:right;"> 17.850 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 93.497 </td>
   <td style="text-align:right;"> 107.220 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 99.5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:right;"> 17.591 </td>
   <td style="text-align:right;"> 17.886 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 93.538 </td>
   <td style="text-align:right;"> 107.181 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 99.0 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 17.635 </td>
   <td style="text-align:right;"> 17.931 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 93.589 </td>
   <td style="text-align:right;"> 107.132 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 95.0 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 18.002 </td>
   <td style="text-align:right;"> 18.305 </td>
   <td style="text-align:right;"> 98.345 </td>
   <td style="text-align:right;"> 94.008 </td>
   <td style="text-align:right;"> 106.734 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 80.0 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 19.602 </td>
   <td style="text-align:right;"> 19.947 </td>
   <td style="text-align:right;"> 98.267 </td>
   <td style="text-align:right;"> 95.764 </td>
   <td style="text-align:right;"> 105.099 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 50.0 </td>
   <td style="text-align:right;"> 10 </td>
   <td style="text-align:right;"> 24.609 </td>
   <td style="text-align:right;"> 25.231 </td>
   <td style="text-align:right;"> 97.535 </td>
   <td style="text-align:right;"> 100.832 </td>
   <td style="text-align:right;"> 100.832 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 20.0 </td>
   <td style="text-align:right;"> 25 </td>
   <td style="text-align:right;"> 19.602 </td>
   <td style="text-align:right;"> 19.947 </td>
   <td style="text-align:right;"> 98.267 </td>
   <td style="text-align:right;"> 105.099 </td>
   <td style="text-align:right;"> 95.764 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 5.0 </td>
   <td style="text-align:right;"> 100 </td>
   <td style="text-align:right;"> 18.002 </td>
   <td style="text-align:right;"> 18.305 </td>
   <td style="text-align:right;"> 98.345 </td>
   <td style="text-align:right;"> 106.734 </td>
   <td style="text-align:right;"> 94.008 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 1.0 </td>
   <td style="text-align:right;"> 500 </td>
   <td style="text-align:right;"> 17.635 </td>
   <td style="text-align:right;"> 17.931 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 107.132 </td>
   <td style="text-align:right;"> 93.589 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.5 </td>
   <td style="text-align:right;"> 1000 </td>
   <td style="text-align:right;"> 17.591 </td>
   <td style="text-align:right;"> 17.886 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 107.181 </td>
   <td style="text-align:right;"> 93.538 </td>
  </tr>
  <tr>
   <td style="text-align:right;"> 0.1 </td>
   <td style="text-align:right;"> 5000 </td>
   <td style="text-align:right;"> 17.556 </td>
   <td style="text-align:right;"> 17.850 </td>
   <td style="text-align:right;"> 98.349 </td>
   <td style="text-align:right;"> 107.220 </td>
   <td style="text-align:right;"> 93.497 </td>
  </tr>
</tbody>
</table>

</div>
</div>
<p>There results show that when <span class="math inline">\(p &gt; 50\%\)</span> overestimation is observed on the right side of distribution nd opposite is true for <span class="math inline">\(p &lt; 50\%\)</span>. The ratio between <span class="math inline">\(p_1\)</span> probabilities is the same across all 3 examples. This is due to the fact that all 3 cases have 5 expected success/failures. Overestimation <span class="math inline">\(ratio_2\)</span> are the same for <span class="math inline">\(p &gt; 50\%\)</span> cases as underestimation <span class="math inline">\(ratio_3\)</span>. As implied probability becomes closer to 50% the binomial distribution becomes more symmetrical which can be supported by seeing that <span class="math inline">\(ratio_2\)</span> and <span class="math inline">\(ratio_3\)</span> are close to 100% for given example.</p>
<p>Finally let’s compare cumulative probabilities for example with <span class="math inline">\(p=10%\)</span> and 50 observations. I have also added 95% and 99% confidence intervals, i.e.&nbsp;Z and Z=.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">0.1%</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">1%</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">10%</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">20%</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">50%</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function for plotting</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>vline <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>) {</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">y0 =</span> <span class="dv">0</span>,</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="dv">1</span>,</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">x0 =</span> x,</span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> x,</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">dash =</span> <span class="st">"dot"</span>)</span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function to draw cum. probabilities</span></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>PlotCumProbs <span class="ot">&lt;-</span> <span class="cf">function</span>(p, N){</span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create vector</span></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(N<span class="sc">*</span>p<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate z values as events for different confidence intervals</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  Z<span class="fl">.95</span> <span class="ot">&lt;-</span> (N <span class="sc">*</span> p <span class="sc">+</span> <span class="fl">1.960</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N))</span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  Z<span class="fl">.99</span> <span class="ot">&lt;-</span> (N <span class="sc">*</span> p <span class="sc">+</span> <span class="fl">2.576</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N))</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate cum. probabilities for both binomial and normal distributions</span></span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data.table for plotting</span></span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x, <span class="at">y.binom =</span> y.binom, <span class="at">y.norm =</span> y.norm)</span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>  dt[, error <span class="sc">:</span><span class="er">=</span> y.binom <span class="sc">-</span> y.norm]</span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add hover text messages</span></span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(error, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>error, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb16-53"><a href="#cb16-53" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb16-54"><a href="#cb16-54" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb16-55"><a href="#cb16-55" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-56"><a href="#cb16-56" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb16-57"><a href="#cb16-57" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, N, <span class="st">" trials"</span>),</span>
<span id="cb16-58"><a href="#cb16-58" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb16-59"><a href="#cb16-59" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb16-60"><a href="#cb16-60" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb16-61"><a href="#cb16-61" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shapes =</span> <span class="fu">list</span>(<span class="fu">vline</span>(Z<span class="fl">.95</span>), <span class="fu">vline</span>(Z<span class="fl">.99</span>)),</span>
<span id="cb16-62"><a href="#cb16-62" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb16-63"><a href="#cb16-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb16-64"><a href="#cb16-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure object</span></span>
<span id="cb16-65"><a href="#cb16-65" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb16-66"><a href="#cb16-66" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb16-67"><a href="#cb16-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-68"><a href="#cb16-68" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 0.1%</span></span>
<span id="cb16-69"><a href="#cb16-69" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.001</span>, <span class="dv">5000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-33b59ec12a93bb9b766a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-33b59ec12a93bb9b766a">{"x":{"visdat":{"3c407e3e2a84":["function () ","plotlyVisDat"]},"cur_data":"3c407e3e2a84","attrs":{"3c407e3e2a84":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c407e3e2a84.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c407e3e2a84.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c407e3e2a84.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 0%, 5000 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","shapes":[{"type":"line","y0":0,"y1":1,"yref":"paper","x0":9.38050134117089,"x1":9.38050134117089,"line":{"color":"black","dash":"dot"}},{"type":"line","y0":0,"y1":1,"yref":"paper","x0":10.7572303341103,"x1":10.7572303341103,"line":{"color":"black","dash":"dot"}}],"legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.26370652038165,3.67470969932015,8.97474091865153,18.5427025530911,32.7279649350482,50,67.2720350649518,81.4572974469089,91.0252590813485,96.3252903006798,98.7362934796183,99.6369430268834,99.9132082717771,99.982787319157,99.9971745837024,99.9996168219579],"text":["0.672%","4.036%","12.453%","26.489%","44.041%","61.596%","76.226%","86.673%","93.2%","96.824%","98.635%","99.457%","99.799%","99.931%","99.978%","99.993%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.672111195986562,4.0360310958192,12.4525654197749,26.4885475856509,44.0405503090948,61.596066946998,76.2256641452506,86.6732843952254,93.2004325318776,96.8244480471893,98.6350047475817,99.4571612618195,99.7993149863383,99.9307281516498,99.9775862565696,99.9931774818702],"text":["1.264%","3.675%","8.975%","18.543%","32.728%","50%","67.272%","81.457%","91.025%","96.325%","98.736%","99.637%","99.913%","99.983%","99.997%","100%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-0.59159532439509,0.36132139649905,3.47782450112332,7.94584503255975,11.3125853740467,11.596066946998,8.9536290802988,5.21598694831648,2.17517345052909,0.499157746509439,-0.101288732036608,-0.179781765063922,-0.113893285438735,-0.0520591675071955,-0.0195883271328512,-0.00643934008762415],"text":["-0.592%","0.361%","3.478%","7.946%","11.313%","11.596%","8.954%","5.216%","2.175%","0.499%","-0.101%","-0.18%","-0.114%","-0.052%","-0.02%","-0.006%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 1%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.01</span>, <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e42f384a0b642e293b28" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e42f384a0b642e293b28">{"x":{"visdat":{"3c405712203e":["function () ","plotlyVisDat"]},"cur_data":"3c405712203e","attrs":{"3c405712203e":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c405712203e.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c405712203e.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c405712203e.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 1%, 500 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","shapes":[{"type":"line","y0":0,"y1":1,"yref":"paper","x0":9.36072471041225,"x1":9.36072471041225,"line":{"color":"black","dash":"dot"}},{"type":"line","y0":0,"y1":1,"yref":"paper","x0":10.7312381908275,"x1":10.7312381908275,"line":{"color":"black","dash":"dot"}}],"legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.23093806904076,3.60990988508288,8.87649262060767,18.4344134680891,32.6547557466091,50,67.3452442533909,81.5655865319109,91.1235073793923,96.3900901149171,98.7690619309592,99.6499529005276,99.917315241815,99.9838260026637,99.9973860671084,99.9996516034464],"text":["0.657%","3.975%","12.339%","26.362%","43.961%","61.596%","76.292%","86.768%","93.289%","96.89%","98.676%","99.479%","99.81%","99.935%","99.979%","99.994%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.657048304241463,3.97547408323876,12.3385774353582,26.3615588136595,43.9611086748103,61.5962131821453,76.2921336049243,86.7680133868189,93.2889840086295,96.8897893351512,98.6756432900221,99.4791955745829,99.8099506816117,99.935365205489,99.979432213518,99.9938541434184],"text":["1.231%","3.61%","8.876%","18.434%","32.655%","50%","67.345%","81.566%","91.124%","96.39%","98.769%","99.65%","99.917%","99.984%","99.997%","100%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-0.573889764799297,0.365564198155875,3.4620848147505,7.92714534557039,11.3063529282012,11.5962131821453,8.94688935153337,5.20242685490803,2.1654766292372,0.499699220234078,-0.0934186409371875,-0.170757325944692,-0.107364560203308,-0.0484607971747408,-0.0179538535903703,-0.00579746002794934],"text":["-0.574%","0.366%","3.462%","7.927%","11.306%","11.596%","8.947%","5.202%","2.165%","0.5%","-0.093%","-0.171%","-0.107%","-0.048%","-0.018%","-0.006%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.1</span>, <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-39c1409c716e3f2bf967" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-39c1409c716e3f2bf967">{"x":{"visdat":{"3c405185362a":["function () ","plotlyVisDat"]},"cur_data":"3c405185362a","attrs":{"3c405185362a":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c405185362a.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c405185362a.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c405185362a.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 10%, 50 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","shapes":[{"type":"line","y0":0,"y1":1,"yref":"paper","x0":9.1577878733769,"x1":9.1577878733769,"line":{"color":"black","dash":"dot"}},{"type":"line","y0":0,"y1":1,"yref":"paper","x0":10.4645212050096,"x1":10.4645212050096,"line":{"color":"black","dash":"dot"}}],"legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.921106272704951,2.967321939596,7.86496035251426,17.288929307558,31.8675944116969,50,68.1324055883031,82.711070692442,92.1350396474857,97.032678060404,99.0788937272951,99.7661132509476,99.9516285774876,99.9918779577407,99.9988954751501,99.9998785766264],"text":["0.515%","3.379%","11.173%","25.029%","43.12%","61.612%","77.023%","87.785%","94.213%","97.546%","99.065%","99.678%","99.9%","99.971%","99.993%","99.998%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.515377520732011,3.37858596924318,11.1728756346347,25.0293905953307,43.1198406829062,61.6123007724277,77.0226841803622,87.7854916398722,94.2132794281906,97.5462064295409,99.0645398412671,99.678007886409,99.8995380138214,99.9714879697331,99.9926161313897,99.9982503078315],"text":["0.921%","2.967%","7.865%","17.289%","31.868%","50%","68.132%","82.711%","92.135%","97.033%","99.079%","99.766%","99.952%","99.992%","99.999%","100%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-0.40572875197294,0.411264029647185,3.30791528212045,7.74046128777272,11.2522462712093,11.6123007724277,8.89027859205912,5.07442094743018,2.07823978070482,0.51352836913685,-0.0143538860279619,-0.0881053645386203,-0.0520905636662405,-0.0203899880075795,-0.00627934376039718,-0.00162826879490297],"text":["-0.406%","0.411%","3.308%","7.74%","11.252%","11.612%","8.89%","5.074%","2.078%","0.514%","-0.014%","-0.088%","-0.052%","-0.02%","-0.006%","-0.002%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.2</span>, <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-a7650be79131825c2361" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a7650be79131825c2361">{"x":{"visdat":{"3c407d1f66dd":["function () ","plotlyVisDat"]},"cur_data":"3c407d1f66dd","attrs":{"3c407d1f66dd":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c407d1f66dd.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c407d1f66dd.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c407d1f66dd.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 20%, 25 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","shapes":[{"type":"line","y0":0,"y1":1,"yref":"paper","x0":8.92,"x1":8.92,"line":{"color":"black","dash":"dot"}},{"type":"line","y0":0,"y1":1,"yref":"paper","x0":10.152,"x1":10.152,"line":{"color":"black","dash":"dot"}}],"legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.620966532577613,2.27501319481792,6.68072012688581,15.8655253931457,30.8537538725987,50,69.1462461274013,84.1344746068543,93.3192798731142,97.7249868051821,99.3790334674224,99.865010196837,99.9767370920964,99.9968328758167,99.9996602326875,99.9999713348428],"text":["0.378%","2.739%","9.823%","23.399%","42.067%","61.669%","78.004%","89.088%","95.323%","98.267%","99.445%","99.846%","99.963%","99.992%","99.999%","100%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.377789318629571,2.73897256006439,9.82252228436886,23.3993259226191,42.0674309252132,61.6689411779369,78.0035330552067,89.0877204004969,95.3225757822227,98.2668130458154,99.4445079512525,99.8459948508333,99.9630951965444,99.9923702829722,99.9986435157781,99.9997936084592],"text":["0.621%","2.275%","6.681%","15.866%","30.854%","50%","69.146%","84.134%","93.319%","97.725%","99.379%","99.865%","99.977%","99.997%","100%","100%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-0.243177213948042,0.463959365246471,3.14180215748305,7.5338005294734,11.2136770526145,11.6689411779369,8.85728692780543,4.95324579364265,2.00329590910852,0.541826240633341,0.0654744838301298,-0.0190153460036555,-0.013641895552027,-0.00446259284450434,-0.00101671690939042,-0.000177726383583376],"text":["-0.243%","0.464%","3.142%","7.534%","11.214%","11.669%","8.857%","4.953%","2.003%","0.542%","0.065%","-0.019%","-0.014%","-0.004%","-0.001%","0%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-e6515b7577212b7cd8a0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-e6515b7577212b7cd8a0">{"x":{"visdat":{"3c40658f468f":["function () ","plotlyVisDat"]},"cur_data":"3c40658f468f","attrs":{"3c40658f468f":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"3c40658f468f.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"3c40658f468f.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"3c40658f468f.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 50%, 10 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","shapes":[{"type":"line","y0":0,"y1":1,"yref":"paper","x0":8.09903210696501,"x1":8.09903210696501,"line":{"color":"black","dash":"dot"}},{"type":"line","y0":0,"y1":1,"yref":"paper","x0":9.07301362629687,"x1":9.07301362629687,"line":{"color":"black","dash":"dot"}}],"legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.0782701129001275,0.570601819300083,2.88897855617986,10.2951605366034,26.3544628432769,50,73.6455371567231,89.7048394633966,97.1110214438201,99.4293981806999,99.9217298870999,99.9926098844833,99.9995226540077,99.9999789980301,99.9999993725676,99.9999999873019],"text":["0.098%","1.074%","5.469%","17.188%","37.695%","62.305%","82.812%","94.531%","98.926%","99.902%","100%","100%","100%","100%","100%","100%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.09765625,1.07421875,5.46875,17.1875,37.6953125,62.3046875,82.8125,94.53125,98.92578125,99.90234375,100,100,100,100,100,100],"text":["0.078%","0.571%","2.889%","10.295%","26.354%","50%","73.646%","89.705%","97.111%","99.429%","99.922%","99.993%","100%","100%","100%","100%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.0193861370998725,0.503616930699918,2.57977144382014,6.89233946339659,11.3408496567231,12.3046875,9.16696284327691,4.82641053660342,1.81475980617986,0.472945569300094,0.0782701129001282,0.00739011551672775,0.000477345992266009,2.10019698840824e-05,6.27432370947645e-07,1.26981376524782e-08],"text":["0.019%","0.504%","2.58%","6.892%","11.341%","12.305%","9.167%","4.826%","1.815%","0.473%","0.078%","0.007%","0%","0%","0%","0%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
<p>When running statistical tests, probabilities calculated at large Z values will be very similiar to both m</p>
</section>
<section id="min.-sample-size" class="level2">
<h2 class="anchored" data-anchor-id="min.-sample-size">Min. sample size</h2>
<p>Finally let’s investigate for different probabilities how much <span class="math inline">\(p_1\)</span> and <span class="math inline">\(ratio_1\)</span> are affected as sample size is increased.</p>
<p>Now let’s investigate how these probabilities and errors change as sample size is increased and “success-failure” condition is met.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data.table</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="conclusions" class="level2">
<h2 class="anchored" data-anchor-id="conclusions">Conclusions</h2>
<p>One should be very mindful when designing experiments for one-sample binomial test. Failing to meet “success-failure” condition would result in overestimation or underestimation of you <span class="math inline">\(H_0\)</span> hypothesis results.</p>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Content for this blog post was prepared using following references:</p>
<ul>
<li>https://statistics.laerd.com/spss-tutorials/binomial-test-using-spss-statistics.php</li>
<li>http://mlwiki.org/index.php/Binomial_Proportion_Tests</li>
<li>https://sites.ualberta.ca/~lkgray/uploads/7/3/6/2/7362679/slides_-_binomialproportionaltests.pdf</li>
<li>https://www.technologynetworks.com/informatics/articles/the-binomial-test-366022</li>
<li>https://towardsdatascience.com/turning-a-two-sample-event-rate-test-into-a-one-sample-binomial-test-23fbfb9d1df6</li>
<li>https://www.studysmarter.us/explanations/math/statistics/binomial-hypothesis-test/</li>
<li>https://www.statology.org/success-failure-condition/</li>
<li>https://towardsdatascience.com/bernoulli-and-binomial-random-variables-d0698288dd36</li>
<li>https://ubc-mds.github.io/DSCI_551_stat-prob-dsci/lectures/simulation.html</li>
<li>https://math.stackexchange.com/questions/1978138/probability-of-x-red-balls-when-drawing-y-balls-from-a-red-and-b-green-balls</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb22" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "One-Sample Binomial Test (Part 1)"</span></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tomas Kristijonas Uždavinys"</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-04-08"</span></span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Python, Statistics]</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>The binomial test is a statistical test used to determine whether the proportion of cases in one of only two categories is equivalent to a pre-specified proportion. Categories could include the default rate of clients within the next 12 months, patients with high or low risk of heart disease, potential customers who are likely or not likely to make a purchase, or the rate of manufacturing defects. This widely used test finds applications in diverse fields, including credit risk, medicine, and manufacturing. It is also known to as the **one-sample proportion test** or **test of one proportion**.</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>As with all statistical tests, the binomial test has assumptions and conditions that must be met before applying it to real-life data:</span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>The "success-failure" condition requires observing a minimum of **n** successes and **n** failures in the sample;</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>observations are independent, i.e. the occurrence of one event does not affect the probability of occurrence of the other.</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>The aim of this blog post is to showcase the ramifications of failing to meet "success-failure" condition critereon. Practical examples are coded in both <span class="in">`R`</span> and <span class="in">`Python`</span> languages.</span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries for blog post</span></span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a><span class="co"># set style</span></span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"ggplot"</span>)</span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theory</span></span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>Suppose that we have a sample where outcomes are binary - e.g. only "success" and "failure". For the given sample, we would like to estimate the true proportion and also set up a statistical test to verify whether if the proportion is equal to some value, e.g. expected.</span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>First, we calculate a point estimate:</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>$$p = \frac{n_s}{n}$$</span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>, where $n$ - sample size and $n_s$ - the number of successful observations (or it can be the number of failures).</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>$$SE = \sqrt{\frac{p \cdot (1 - p)}{n}}$$ , where $SE$ is standard error. To perform a test, one first needs to derive a Null hypothesis:</span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>$$H_0: p = p_0$$</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>and an alternative hypothesis:</span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>one-sided $H_A: p &lt; p_0$ or $H_A: p &gt; p_0$,</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>two-sided $H_A: p \ne p_0$.</span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>Finally, we needs to calculate $Z$ statistics:</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{p_0-p}{SE}$$</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a>Obtaining the value of $Z$ enables us to either compute confidence intervals ($CI$) or reject $H_0$ in favor of $H_A$</span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## "Success-failure" condition</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>To approximate any distribution as normal, it is imperative to calculate the mean ($\mu$) and standard deviation ($\sigma$). For the Binomial distribution, which consists of a number of experiments $n$ and a probability $p$, the mean of the normal distribution is:</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>$$\mu = n \cdot p$$</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a>and the standard deviation:</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>$$\sigma = \sqrt{n \cdot p \cdot (1 - p)}.$$</span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>Meeting the "Success-Failure" condition is crucial to approximate Binomial distribution as Normal. Below, I present an instance of 50 Binomial events with varying probability rates of 5%, 30%, and 90%. In tabs <span class="in">`binomial vs normal`</span> binomial distributions are plotted against it's normal distribution approximation.</span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## binomial vs. normal (R)</span></span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>)</span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table</span></span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">CJ</span>(p, x)</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a><span class="co"># add size column</span></span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>dt[, size <span class="sc">:</span><span class="er">=</span> <span class="dv">50</span>]</span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a><span class="co"># add binomial probability</span></span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a>dt[, Binomial <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a><span class="co"># create label column</span></span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">"Prob: "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"%, exp. successes "</span>, <span class="fu">round</span>(p<span class="sc">*</span>size),</span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" exp. failures "</span>, <span class="fu">round</span>((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>size))]</span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> size <span class="sc">*</span> p]</span>
<span id="cb22-120"><a href="#cb22-120" aria-hidden="true" tabindex="-1"></a>dt[, st.dev <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> size)]</span>
<span id="cb22-121"><a href="#cb22-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-122"><a href="#cb22-122" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb22-123"><a href="#cb22-123" aria-hidden="true" tabindex="-1"></a>dt[, Normal <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>mu, <span class="at">sd =</span> st.dev) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-124"><a href="#cb22-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-125"><a href="#cb22-125" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to ordered factor</span></span>
<span id="cb22-126"><a href="#cb22-126" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(label, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Prob: 5%, exp. successes 2 exp. failures 48"</span>,</span>
<span id="cb22-127"><a href="#cb22-127" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 30%, exp. successes 15 exp. failures 35"</span>,</span>
<span id="cb22-128"><a href="#cb22-128" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 90%, exp. successes 45 exp. failures 5"</span> ))]</span>
<span id="cb22-129"><a href="#cb22-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-130"><a href="#cb22-130" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape for plotting</span></span>
<span id="cb22-131"><a href="#cb22-131" aria-hidden="true" tabindex="-1"></a>dt.plot <span class="ot">&lt;-</span> <span class="fu">melt</span>(dt, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"label"</span>),</span>
<span id="cb22-132"><a href="#cb22-132" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"Binomial"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb22-133"><a href="#cb22-133" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="fu">c</span>(<span class="st">"Type"</span>),</span>
<span id="cb22-134"><a href="#cb22-134" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="fu">c</span>(<span class="st">'prob'</span>))</span>
<span id="cb22-135"><a href="#cb22-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-136"><a href="#cb22-136" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb22-137"><a href="#cb22-137" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt.plot, <span class="fu">aes</span>(x, prob, <span class="at">color=</span>Type)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Probability, %"</span>)</span>
<span id="cb22-138"><a href="#cb22-138" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb22-139"><a href="#cb22-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-140"><a href="#cb22-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-141"><a href="#cb22-141" aria-hidden="true" tabindex="-1"></a><span class="fu">## error (R)</span></span>
<span id="cb22-142"><a href="#cb22-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-145"><a href="#cb22-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-146"><a href="#cb22-146" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use data.table from previous code chunk)</span></span>
<span id="cb22-147"><a href="#cb22-147" aria-hidden="true" tabindex="-1"></a>dt[, Error <span class="sc">:</span><span class="er">=</span> Binomial <span class="sc">-</span> Normal]</span>
<span id="cb22-148"><a href="#cb22-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-149"><a href="#cb22-149" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb22-150"><a href="#cb22-150" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(x, Error)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Error (binom. - norm.), %"</span>)</span>
<span id="cb22-151"><a href="#cb22-151" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb22-152"><a href="#cb22-152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-153"><a href="#cb22-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-154"><a href="#cb22-154" aria-hidden="true" tabindex="-1"></a><span class="fu">## binomial vs. normal (Python)</span></span>
<span id="cb22-155"><a href="#cb22-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-158"><a href="#cb22-158" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-159"><a href="#cb22-159" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb22-160"><a href="#cb22-160" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>]</span>
<span id="cb22-161"><a href="#cb22-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-162"><a href="#cb22-162" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb22-163"><a href="#cb22-163" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">51</span>)</span>
<span id="cb22-164"><a href="#cb22-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-165"><a href="#cb22-165" aria-hidden="true" tabindex="-1"></a><span class="co"># create DataFrame with all combinations</span></span>
<span id="cb22-166"><a href="#cb22-166" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> pd.DataFrame({<span class="st">'p'</span>: p})</span>
<span id="cb22-167"><a href="#cb22-167" aria-hidden="true" tabindex="-1"></a>df_2 <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x})</span>
<span id="cb22-168"><a href="#cb22-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-169"><a href="#cb22-169" aria-hidden="true" tabindex="-1"></a><span class="co"># create key for joining</span></span>
<span id="cb22-170"><a href="#cb22-170" aria-hidden="true" tabindex="-1"></a>df_1[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-171"><a href="#cb22-171" aria-hidden="true" tabindex="-1"></a>df_2[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb22-172"><a href="#cb22-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-173"><a href="#cb22-173" aria-hidden="true" tabindex="-1"></a><span class="co"># perform cross join</span></span>
<span id="cb22-174"><a href="#cb22-174" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_1.merge(df_2, on<span class="op">=</span><span class="st">'key'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb22-175"><a href="#cb22-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-176"><a href="#cb22-176" aria-hidden="true" tabindex="-1"></a><span class="co"># drop key column</span></span>
<span id="cb22-177"><a href="#cb22-177" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> df[<span class="st">'key'</span>]</span>
<span id="cb22-178"><a href="#cb22-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-179"><a href="#cb22-179" aria-hidden="true" tabindex="-1"></a><span class="co"># add size value</span></span>
<span id="cb22-180"><a href="#cb22-180" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb22-181"><a href="#cb22-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-182"><a href="#cb22-182" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate binomial probability</span></span>
<span id="cb22-183"><a href="#cb22-183" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Binomial'</span>] <span class="op">=</span> binom.pmf(df[<span class="st">'x'</span>], df[<span class="st">'size'</span>], df[<span class="st">'p'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-184"><a href="#cb22-184" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb22-185"><a href="#cb22-185" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb22-186"><a href="#cb22-186" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mu'</span>] <span class="op">=</span> df[<span class="st">'size'</span>] <span class="op">*</span> df[<span class="st">'p'</span>]</span>
<span id="cb22-187"><a href="#cb22-187" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'se'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">/</span> df[<span class="st">'size'</span>])</span>
<span id="cb22-188"><a href="#cb22-188" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'std'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">*</span> df[<span class="st">'size'</span>])</span>
<span id="cb22-189"><a href="#cb22-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-190"><a href="#cb22-190" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb22-191"><a href="#cb22-191" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Normal'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: norm.pdf(x[<span class="st">'x'</span>], x[<span class="st">'mu'</span>], x[<span class="st">'std'</span>]) <span class="op">*</span> <span class="dv">100</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb22-192"><a href="#cb22-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-193"><a href="#cb22-193" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb22-194"><a href="#cb22-194" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-195"><a href="#cb22-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-196"><a href="#cb22-196" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb22-197"><a href="#cb22-197" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb22-198"><a href="#cb22-198" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb22-199"><a href="#cb22-199" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p].copy()</span>
<span id="cb22-200"><a href="#cb22-200" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-201"><a href="#cb22-201" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb22-202"><a href="#cb22-202" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Binomial'</span>], <span class="st">"o"</span>, label<span class="op">=</span><span class="st">'Binomial'</span>)<span class="op">;</span></span>
<span id="cb22-203"><a href="#cb22-203" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Normal'</span>], <span class="st">"-"</span>, label<span class="op">=</span><span class="st">'Normal'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb22-204"><a href="#cb22-204" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-205"><a href="#cb22-205" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb22-206"><a href="#cb22-206" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb22-207"><a href="#cb22-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-208"><a href="#cb22-208" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb22-209"><a href="#cb22-209" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)<span class="op">;</span></span>
<span id="cb22-210"><a href="#cb22-210" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb22-211"><a href="#cb22-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-212"><a href="#cb22-212" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend and white background</span></span>
<span id="cb22-213"><a href="#cb22-213" aria-hidden="true" tabindex="-1"></a>legend <span class="op">=</span> ax[<span class="dv">1</span>].legend(frameon <span class="op">=</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb22-214"><a href="#cb22-214" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> legend.get_frame()<span class="op">;</span></span>
<span id="cb22-215"><a href="#cb22-215" aria-hidden="true" tabindex="-1"></a>frame.set_color(<span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb22-216"><a href="#cb22-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-217"><a href="#cb22-217" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-218"><a href="#cb22-218" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-219"><a href="#cb22-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-220"><a href="#cb22-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-221"><a href="#cb22-221" aria-hidden="true" tabindex="-1"></a><span class="fu">## error (Python)</span></span>
<span id="cb22-222"><a href="#cb22-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-225"><a href="#cb22-225" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-226"><a href="#cb22-226" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use DataFrame from previous code chunk)</span></span>
<span id="cb22-227"><a href="#cb22-227" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Error'</span>] <span class="op">=</span> df.Binomial <span class="op">-</span> df.Normal</span>
<span id="cb22-228"><a href="#cb22-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-229"><a href="#cb22-229" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb22-230"><a href="#cb22-230" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb22-231"><a href="#cb22-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-232"><a href="#cb22-232" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb22-233"><a href="#cb22-233" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb22-234"><a href="#cb22-234" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb22-235"><a href="#cb22-235" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p]</span>
<span id="cb22-236"><a href="#cb22-236" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-237"><a href="#cb22-237" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb22-238"><a href="#cb22-238" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Error'</span>], <span class="st">"o"</span>, color<span class="op">=</span><span class="st">'k'</span>, markersize<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb22-239"><a href="#cb22-239" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-240"><a href="#cb22-240" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb22-241"><a href="#cb22-241" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb22-242"><a href="#cb22-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-243"><a href="#cb22-243" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust limits for better readability</span></span>
<span id="cb22-244"><a href="#cb22-244" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">4.9</span>, <span class="fl">4.9</span>)</span>
<span id="cb22-245"><a href="#cb22-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-246"><a href="#cb22-246" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb22-247"><a href="#cb22-247" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)</span>
<span id="cb22-248"><a href="#cb22-248" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb22-249"><a href="#cb22-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-250"><a href="#cb22-250" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb22-251"><a href="#cb22-251" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb22-252"><a href="#cb22-252" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-253"><a href="#cb22-253" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-254"><a href="#cb22-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-255"><a href="#cb22-255" aria-hidden="true" tabindex="-1"></a>The first thing to notice is that the "Success-Failure" criterion is only met for the p=30% case. In tabs <span class="in">`error`</span> one can see that approximation error, i.e. the difference between probabilities calculated using Binomial and Normal distribution approximations, is above 2% for the $p=5\%$ and $p=90\%$ examples.</span>
<span id="cb22-256"><a href="#cb22-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-257"><a href="#cb22-257" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating approximation error</span></span>
<span id="cb22-258"><a href="#cb22-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-259"><a href="#cb22-259" aria-hidden="true" tabindex="-1"></a>Let's dive deeper into understanding approximation error. We have to be mindful, when comparing discrete binomial distribution with a continuous normal distribution. The binomial distribution probability spaces bounded between 0 and <span class="in">`k`</span> events, where <span class="in">`k`</span> number of attempts while for normal it's mathematical y unbounded (for large <span class="in">`Z`</span> values you can calculate very small probability values). Apart for case $p=50\%$ binomial distribution is not symmetrical as oppose to normal distribution. In examples bellow, we will compare areas under the curve for both distributions using interactive charts by <span class="in">`plotly`</span> library/package. First I have created a functions which visualizes both distributions using interactive charts.</span>
<span id="cb22-260"><a href="#cb22-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-261"><a href="#cb22-261" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-262"><a href="#cb22-262" aria-hidden="true" tabindex="-1"></a><span class="fu">## plot_ly function (R)</span></span>
<span id="cb22-263"><a href="#cb22-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-266"><a href="#cb22-266" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-267"><a href="#cb22-267" aria-hidden="true" tabindex="-1"></a>PlotDistributions <span class="ot">&lt;-</span> <span class="cf">function</span>(prob, size){</span>
<span id="cb22-268"><a href="#cb22-268" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb22-269"><a href="#cb22-269" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (prob <span class="sc">&lt;</span> <span class="fl">0.5</span>){</span>
<span id="cb22-270"><a href="#cb22-270" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(size<span class="sc">*</span>prob<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb22-271"><a href="#cb22-271" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb22-272"><a href="#cb22-272" aria-hidden="true" tabindex="-1"></a>    x <span class="ot">&lt;-</span> (size <span class="sc">-</span> <span class="dv">3</span> <span class="sc">*</span> size <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob))<span class="sc">:</span>size</span>
<span id="cb22-273"><a href="#cb22-273" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb22-274"><a href="#cb22-274" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-275"><a href="#cb22-275" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb22-276"><a href="#cb22-276" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>prob) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb22-277"><a href="#cb22-277" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>size <span class="sc">*</span> prob, <span class="at">sd =</span> <span class="fu">sqrt</span>(prob <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob) <span class="sc">*</span> size)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb22-278"><a href="#cb22-278" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-279"><a href="#cb22-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data table for plotting</span></span>
<span id="cb22-280"><a href="#cb22-280" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x,</span>
<span id="cb22-281"><a href="#cb22-281" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.binom =</span> y.binom,</span>
<span id="cb22-282"><a href="#cb22-282" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.norm =</span> y.norm)</span>
<span id="cb22-283"><a href="#cb22-283" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-284"><a href="#cb22-284" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns with hover information</span></span>
<span id="cb22-285"><a href="#cb22-285" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb22-286"><a href="#cb22-286" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-287"><a href="#cb22-287" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb22-288"><a href="#cb22-288" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-289"><a href="#cb22-289" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate error&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb22-290"><a href="#cb22-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom <span class="sc">-</span> y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-291"><a href="#cb22-291" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb22-292"><a href="#cb22-292" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb22-293"><a href="#cb22-293" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-294"><a href="#cb22-294" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb22-295"><a href="#cb22-295" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb22-296"><a href="#cb22-296" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb22-297"><a href="#cb22-297" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-298"><a href="#cb22-298" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb22-299"><a href="#cb22-299" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb22-300"><a href="#cb22-300" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb22-301"><a href="#cb22-301" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-302"><a href="#cb22-302" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb22-303"><a href="#cb22-303" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>(prob.binom<span class="sc">-</span>prob.norm), <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb22-304"><a href="#cb22-304" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb22-305"><a href="#cb22-305" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-306"><a href="#cb22-306" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb22-307"><a href="#cb22-307" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb22-308"><a href="#cb22-308" aria-hidden="true" tabindex="-1"></a>                           <span class="at">visible =</span> <span class="st">"legendonly"</span>) </span>
<span id="cb22-309"><a href="#cb22-309" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-310"><a href="#cb22-310" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb22-311"><a href="#cb22-311" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(prob<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, size, <span class="st">" trials"</span>),</span>
<span id="cb22-312"><a href="#cb22-312" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb22-313"><a href="#cb22-313" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb22-314"><a href="#cb22-314" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb22-315"><a href="#cb22-315" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb22-316"><a href="#cb22-316" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure</span></span>
<span id="cb22-317"><a href="#cb22-317" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb22-318"><a href="#cb22-318" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-319"><a href="#cb22-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-320"><a href="#cb22-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-321"><a href="#cb22-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## plotly function (Python)</span></span>
<span id="cb22-322"><a href="#cb22-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-325"><a href="#cb22-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-326"><a href="#cb22-326" aria-hidden="true" tabindex="-1"></a><span class="co"># create function for plotting distributions</span></span>
<span id="cb22-327"><a href="#cb22-327" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_distributions(prob, size):</span>
<span id="cb22-328"><a href="#cb22-328" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb22-329"><a href="#cb22-329" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> np.arange(<span class="bu">int</span>(size<span class="op">*</span>prob<span class="op">*</span><span class="dv">3</span>))</span>
<span id="cb22-330"><a href="#cb22-330" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-331"><a href="#cb22-331" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb22-332"><a href="#cb22-332" aria-hidden="true" tabindex="-1"></a>  y_binom <span class="op">=</span> binom.pmf(x, n<span class="op">=</span>size, p<span class="op">=</span>prob) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-333"><a href="#cb22-333" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-334"><a href="#cb22-334" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate variance and sigma</span></span>
<span id="cb22-335"><a href="#cb22-335" aria-hidden="true" tabindex="-1"></a>  variance <span class="op">=</span> size <span class="op">*</span> prob <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> prob)</span>
<span id="cb22-336"><a href="#cb22-336" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> np.sqrt(variance)</span>
<span id="cb22-337"><a href="#cb22-337" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-338"><a href="#cb22-338" aria-hidden="true" tabindex="-1"></a>  y_norm <span class="op">=</span> norm.pdf(x, loc <span class="op">=</span> size <span class="op">*</span> prob, scale <span class="op">=</span> sigma) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb22-339"><a href="#cb22-339" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-340"><a href="#cb22-340" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate Data.Frame</span></span>
<span id="cb22-341"><a href="#cb22-341" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'binom'</span>: y_binom, <span class="st">'norm'</span>: y_norm})</span>
<span id="cb22-342"><a href="#cb22-342" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-343"><a href="#cb22-343" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb22-344"><a href="#cb22-344" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'error'</span>] <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb22-345"><a href="#cb22-345" aria-hidden="true" tabindex="-1"></a>  error <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb22-346"><a href="#cb22-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-347"><a href="#cb22-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate hover messages</span></span>
<span id="cb22-348"><a href="#cb22-348" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_1'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"binom"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb22-349"><a href="#cb22-349" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_2'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"norm"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb22-350"><a href="#cb22-350" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_3'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate error&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"error"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb22-351"><a href="#cb22-351" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-352"><a href="#cb22-352" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb22-353"><a href="#cb22-353" aria-hidden="true" tabindex="-1"></a>  fig <span class="op">=</span> go.Figure()</span>
<span id="cb22-354"><a href="#cb22-354" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_norm, text <span class="op">=</span> df[<span class="st">'text_1'</span>].values,</span>
<span id="cb22-355"><a href="#cb22-355" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Normal'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb22-356"><a href="#cb22-356" aria-hidden="true" tabindex="-1"></a>                           line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FF6666'</span>, width<span class="op">=</span><span class="dv">5</span>)))</span>
<span id="cb22-357"><a href="#cb22-357" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_binom, text <span class="op">=</span> df[<span class="st">'text_2'</span>].values,</span>
<span id="cb22-358"><a href="#cb22-358" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Binomial'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb22-359"><a href="#cb22-359" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#3399FF'</span>, size<span class="op">=</span><span class="dv">12</span>)))</span>
<span id="cb22-360"><a href="#cb22-360" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>error, text <span class="op">=</span> df[<span class="st">'text_3'</span>].values,</span>
<span id="cb22-361"><a href="#cb22-361" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Error'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb22-362"><a href="#cb22-362" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb22-363"><a href="#cb22-363" aria-hidden="true" tabindex="-1"></a>                           visible <span class="op">=</span> <span class="st">"legendonly"</span>))</span>
<span id="cb22-364"><a href="#cb22-364" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb22-365"><a href="#cb22-365" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit the layout</span></span>
<span id="cb22-366"><a href="#cb22-366" aria-hidden="true" tabindex="-1"></a>  fig.update_layout(title<span class="op">=</span><span class="ss">f"p = </span><span class="sc">{</span>prob<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%, </span><span class="sc">{</span>size<span class="sc">}</span><span class="ss"> trials"</span>,</span>
<span id="cb22-367"><a href="#cb22-367" aria-hidden="true" tabindex="-1"></a>                    xaxis_title<span class="op">=</span><span class="st">'Observations'</span>,</span>
<span id="cb22-368"><a href="#cb22-368" aria-hidden="true" tabindex="-1"></a>                    yaxis_title<span class="op">=</span><span class="st">'Probability, %'</span>,</span>
<span id="cb22-369"><a href="#cb22-369" aria-hidden="true" tabindex="-1"></a>                    template<span class="op">=</span><span class="st">"ggplot2"</span>,</span>
<span id="cb22-370"><a href="#cb22-370" aria-hidden="true" tabindex="-1"></a>                    hovermode<span class="op">=</span><span class="st">"x unified"</span>)</span>
<span id="cb22-371"><a href="#cb22-371" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb22-372"><a href="#cb22-372" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> fig</span>
<span id="cb22-373"><a href="#cb22-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-374"><a href="#cb22-374" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-375"><a href="#cb22-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-376"><a href="#cb22-376" aria-hidden="true" tabindex="-1"></a>Next I provide examples using small probabilities (99%, 95%, 0.5% and 0.1%) where "Success-failure" condition is not met, i.e. either 5 failures or 5 successes are expected for all 4 examples.</span>
<span id="cb22-377"><a href="#cb22-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-378"><a href="#cb22-378" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-379"><a href="#cb22-379" aria-hidden="true" tabindex="-1"></a><span class="fu">## 99.9% (R)</span></span>
<span id="cb22-380"><a href="#cb22-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-383"><a href="#cb22-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-384"><a href="#cb22-384" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb22-385"><a href="#cb22-385" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.999</span>, <span class="dv">5000</span>)</span>
<span id="cb22-386"><a href="#cb22-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-387"><a href="#cb22-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-388"><a href="#cb22-388" aria-hidden="true" tabindex="-1"></a><span class="fu">## 99.5% (R)</span></span>
<span id="cb22-389"><a href="#cb22-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-392"><a href="#cb22-392" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-393"><a href="#cb22-393" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb22-394"><a href="#cb22-394" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.995</span>, <span class="dv">1000</span>)</span>
<span id="cb22-395"><a href="#cb22-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-396"><a href="#cb22-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-397"><a href="#cb22-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0.5% (Python)</span></span>
<span id="cb22-398"><a href="#cb22-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-401"><a href="#cb22-401" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-402"><a href="#cb22-402" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb22-403"><a href="#cb22-403" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.005</span>, <span class="dv">1000</span>)</span>
<span id="cb22-404"><a href="#cb22-404" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb22-405"><a href="#cb22-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-406"><a href="#cb22-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-407"><a href="#cb22-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0.01% (Python)</span></span>
<span id="cb22-408"><a href="#cb22-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-411"><a href="#cb22-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb22-412"><a href="#cb22-412" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb22-413"><a href="#cb22-413" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.001</span>, <span class="dv">5000</span>)</span>
<span id="cb22-414"><a href="#cb22-414" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb22-415"><a href="#cb22-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-416"><a href="#cb22-416" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-417"><a href="#cb22-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-418"><a href="#cb22-418" aria-hidden="true" tabindex="-1"></a>Let's taken hypothetical model with small probability, i.e. we expect to have 1% manufacturing defects or 1% of clients in our portfolio will fail to meet their credit obligations. For this hypothetical model to meet "Success-Failure" condition we would need to collect at least 1000 observations, i.e. to manufacture 1000 devices or issue credit to 1000 obligatory. In the tab <span class="in">`1% (R)`</span> that if this condition is not met, i.e. we collected 500 events and expect 5 failures/defaults. From both visual inspection and reviewing error estimates for different outcomes (select <span class="in">`error`</span> on legend to view error values) it's clear that normal distribution approximation overestimates probability for $\ge5$ and underestimates $\le5$. For all 4 examples, expected number of "Successes-failures" is 5. One can observed that the smaller the probability is the larger the error becomes.</span>
<span id="cb22-419"><a href="#cb22-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-420"><a href="#cb22-420" aria-hidden="true" tabindex="-1"></a>Let's compare 3 probabilities calculated using binomial and normal distribution approximation:</span>
<span id="cb22-421"><a href="#cb22-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-422"><a href="#cb22-422" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$p_1$ we would observe more than expected number of occurrences,</span>
<span id="cb22-423"><a href="#cb22-423" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$p_2$ we would observe expected number of occurrences,</span>
<span id="cb22-424"><a href="#cb22-424" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>$p_3$ we would observe less than expected number of occurrences.</span>
<span id="cb22-425"><a href="#cb22-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-426"><a href="#cb22-426" aria-hidden="true" tabindex="-1"></a>We can calculate these probabilities using both binomial and normal distributions and then compare them, e.g. $ratio_1 = \frac{p_1 (binom.)}{p_1 (norm.)}$. $p_1$ probabilities and all 3 ratios are calculated for all 4 examples above and few more examples. For all cases we have 5 expected successes or failures. Results are presented in table bellow.</span>
<span id="cb22-427"><a href="#cb22-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-430"><a href="#cb22-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-431"><a href="#cb22-431" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data.table</span></span>
<span id="cb22-432"><a href="#cb22-432" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">p =</span> <span class="fu">c</span>(<span class="fl">0.999</span>, <span class="fl">0.995</span>, <span class="fl">0.99</span>, <span class="fl">0.95</span>, <span class="fl">0.8</span>,</span>
<span id="cb22-433"><a href="#cb22-433" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.5</span>,</span>
<span id="cb22-434"><a href="#cb22-434" aria-hidden="true" tabindex="-1"></a>                       <span class="fl">0.2</span>, <span class="fl">0.05</span>, <span class="fl">0.01</span>, <span class="fl">0.005</span>, <span class="fl">0.001</span>),</span>
<span id="cb22-435"><a href="#cb22-435" aria-hidden="true" tabindex="-1"></a>                 <span class="at">N =</span> <span class="fu">c</span>(<span class="dv">5000</span>, <span class="dv">1000</span>, <span class="dv">500</span>, <span class="dv">100</span>, <span class="dv">25</span>,</span>
<span id="cb22-436"><a href="#cb22-436" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">10</span>,</span>
<span id="cb22-437"><a href="#cb22-437" aria-hidden="true" tabindex="-1"></a>                       <span class="dv">25</span>, <span class="dv">100</span>, <span class="dv">500</span>, <span class="dv">1000</span>, <span class="dv">5000</span>))</span>
<span id="cb22-438"><a href="#cb22-438" aria-hidden="true" tabindex="-1"></a><span class="co"># expected events</span></span>
<span id="cb22-439"><a href="#cb22-439" aria-hidden="true" tabindex="-1"></a>dt[, x <span class="sc">:</span><span class="er">=</span> p <span class="sc">*</span> N]</span>
<span id="cb22-440"><a href="#cb22-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-441"><a href="#cb22-441" aria-hidden="true" tabindex="-1"></a><span class="co"># get binomial, normal probabilities and their ratio</span></span>
<span id="cb22-442"><a href="#cb22-442" aria-hidden="true" tabindex="-1"></a>dt[, binom.p1 <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-443"><a href="#cb22-443" aria-hidden="true" tabindex="-1"></a>dt[, norm.p1 <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-444"><a href="#cb22-444" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> binom.p1<span class="sc">/</span>norm.p1 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-445"><a href="#cb22-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-446"><a href="#cb22-446" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p2 probabilities</span></span>
<span id="cb22-447"><a href="#cb22-447" aria-hidden="true" tabindex="-1"></a>dt[, binom.p2 <span class="sc">:</span><span class="er">=</span> <span class="fu">pbinom</span>(x<span class="dv">-1</span>, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-448"><a href="#cb22-448" aria-hidden="true" tabindex="-1"></a>dt[, norm.p2 <span class="sc">:</span><span class="er">=</span> (<span class="dv">1</span><span class="sc">-</span><span class="fu">dnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)))<span class="sc">/</span><span class="dv">2</span> <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-449"><a href="#cb22-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-450"><a href="#cb22-450" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate p3 probabilities</span></span>
<span id="cb22-451"><a href="#cb22-451" aria-hidden="true" tabindex="-1"></a>dt[, binom.p3 <span class="sc">:</span><span class="er">=</span> (<span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p)) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-452"><a href="#cb22-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-453"><a href="#cb22-453" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate ratios</span></span>
<span id="cb22-454"><a href="#cb22-454" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> binom.p2<span class="sc">/</span>norm.p2 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-455"><a href="#cb22-455" aria-hidden="true" tabindex="-1"></a>dt[, ratio<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> binom.p3<span class="sc">/</span>norm.p2 <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb22-456"><a href="#cb22-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-457"><a href="#cb22-457" aria-hidden="true" tabindex="-1"></a><span class="co"># round columns for better readability</span></span>
<span id="cb22-458"><a href="#cb22-458" aria-hidden="true" tabindex="-1"></a>cols <span class="ot">&lt;-</span> <span class="fu">names</span>(dt)[<span class="dv">4</span><span class="sc">:</span><span class="dv">11</span>]</span>
<span id="cb22-459"><a href="#cb22-459" aria-hidden="true" tabindex="-1"></a>dt[,(cols) <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(.SD, <span class="dv">3</span>), .SDcols<span class="ot">=</span>cols]</span>
<span id="cb22-460"><a href="#cb22-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-461"><a href="#cb22-461" aria-hidden="true" tabindex="-1"></a><span class="co"># convert probability to percents</span></span>
<span id="cb22-462"><a href="#cb22-462" aria-hidden="true" tabindex="-1"></a>dt[, p <span class="sc">:</span><span class="er">=</span> <span class="fu">round</span>(p <span class="sc">*</span> <span class="dv">100</span>, <span class="dv">1</span>)]</span>
<span id="cb22-463"><a href="#cb22-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-464"><a href="#cb22-464" aria-hidden="true" tabindex="-1"></a><span class="co"># remove column</span></span>
<span id="cb22-465"><a href="#cb22-465" aria-hidden="true" tabindex="-1"></a>dt<span class="sc">$</span>x <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb22-466"><a href="#cb22-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-467"><a href="#cb22-467" aria-hidden="true" tabindex="-1"></a><span class="co"># generate table with first few rows and columns</span></span>
<span id="cb22-468"><a href="#cb22-468" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(dt[, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span>, <span class="dv">10</span>)], <span class="at">col.names =</span> <span class="fu">c</span>(<span class="st">"p, %"</span>, <span class="st">"N"</span>, <span class="st">"p_1 (binom.), %"</span>, <span class="st">"p_1 (norm.), %"</span>, <span class="st">"ratio_1"</span>, <span class="st">"ratio_2"</span>, <span class="st">"ratio_3"</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb22-469"><a href="#cb22-469" aria-hidden="true" tabindex="-1"></a>  <span class="fu">kable_styling</span>(<span class="at">bootstrap_options =</span> <span class="fu">c</span>(<span class="st">"striped"</span>, <span class="st">"hover"</span>, <span class="st">"condensed"</span>))</span>
<span id="cb22-470"><a href="#cb22-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-471"><a href="#cb22-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-472"><a href="#cb22-472" aria-hidden="true" tabindex="-1"></a>There results show that when $p &gt; 50\%$ overestimation is observed on the right side of distribution nd opposite is true for $p &lt; 50\%$. The ratio between $p_1$ probabilities is the same across all 3 examples. This is due to the fact that all 3 cases have 5 expected success/failures. Overestimation $ratio_2$ are the same for $p &gt; 50\%$ cases as underestimation $ratio_3$. As implied probability becomes closer to 50% the binomial distribution becomes more symmetrical which can be supported by seeing that $ratio_2$ and $ratio_3$ are close to 100% for given example.</span>
<span id="cb22-473"><a href="#cb22-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-474"><a href="#cb22-474" aria-hidden="true" tabindex="-1"></a>Finally let's compare cumulative probabilities for example with $p=10%$ and 50 observations. I have also added 95% and 99% confidence intervals, i.e. Z and Z=.</span>
<span id="cb22-475"><a href="#cb22-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-476"><a href="#cb22-476" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb22-477"><a href="#cb22-477" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0.1%</span></span>
<span id="cb22-478"><a href="#cb22-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-481"><a href="#cb22-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-482"><a href="#cb22-482" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function for plotting</span></span>
<span id="cb22-483"><a href="#cb22-483" aria-hidden="true" tabindex="-1"></a>vline <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">"black"</span>) {</span>
<span id="cb22-484"><a href="#cb22-484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">list</span>(</span>
<span id="cb22-485"><a href="#cb22-485" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> <span class="st">"line"</span>,</span>
<span id="cb22-486"><a href="#cb22-486" aria-hidden="true" tabindex="-1"></a>    <span class="at">y0 =</span> <span class="dv">0</span>,</span>
<span id="cb22-487"><a href="#cb22-487" aria-hidden="true" tabindex="-1"></a>    <span class="at">y1 =</span> <span class="dv">1</span>,</span>
<span id="cb22-488"><a href="#cb22-488" aria-hidden="true" tabindex="-1"></a>    <span class="at">yref =</span> <span class="st">"paper"</span>,</span>
<span id="cb22-489"><a href="#cb22-489" aria-hidden="true" tabindex="-1"></a>    <span class="at">x0 =</span> x,</span>
<span id="cb22-490"><a href="#cb22-490" aria-hidden="true" tabindex="-1"></a>    <span class="at">x1 =</span> x,</span>
<span id="cb22-491"><a href="#cb22-491" aria-hidden="true" tabindex="-1"></a>    <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> color, <span class="at">dash =</span> <span class="st">"dot"</span>)</span>
<span id="cb22-492"><a href="#cb22-492" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-493"><a href="#cb22-493" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-494"><a href="#cb22-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-495"><a href="#cb22-495" aria-hidden="true" tabindex="-1"></a><span class="co"># helper function to draw cum. probabilities</span></span>
<span id="cb22-496"><a href="#cb22-496" aria-hidden="true" tabindex="-1"></a>PlotCumProbs <span class="ot">&lt;-</span> <span class="cf">function</span>(p, N){</span>
<span id="cb22-497"><a href="#cb22-497" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-498"><a href="#cb22-498" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create vector</span></span>
<span id="cb22-499"><a href="#cb22-499" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(N<span class="sc">*</span>p<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb22-500"><a href="#cb22-500" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-501"><a href="#cb22-501" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate z values as events for different confidence intervals</span></span>
<span id="cb22-502"><a href="#cb22-502" aria-hidden="true" tabindex="-1"></a>  Z<span class="fl">.95</span> <span class="ot">&lt;-</span> (N <span class="sc">*</span> p <span class="sc">+</span> <span class="fl">1.960</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N))</span>
<span id="cb22-503"><a href="#cb22-503" aria-hidden="true" tabindex="-1"></a>  Z<span class="fl">.99</span> <span class="ot">&lt;-</span> (N <span class="sc">*</span> p <span class="sc">+</span> <span class="fl">2.576</span> <span class="sc">*</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N))</span>
<span id="cb22-504"><a href="#cb22-504" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-505"><a href="#cb22-505" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate cum. probabilities for both binomial and normal distributions</span></span>
<span id="cb22-506"><a href="#cb22-506" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">pbinom</span>(x, <span class="at">size=</span>N, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb22-507"><a href="#cb22-507" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">pnorm</span>(x, <span class="at">mean=</span>N <span class="sc">*</span> p, <span class="at">sd =</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb22-508"><a href="#cb22-508" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-509"><a href="#cb22-509" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data.table for plotting</span></span>
<span id="cb22-510"><a href="#cb22-510" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x, <span class="at">y.binom =</span> y.binom, <span class="at">y.norm =</span> y.norm)</span>
<span id="cb22-511"><a href="#cb22-511" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb22-512"><a href="#cb22-512" aria-hidden="true" tabindex="-1"></a>  dt[, error <span class="sc">:</span><span class="er">=</span> y.binom <span class="sc">-</span> y.norm]</span>
<span id="cb22-513"><a href="#cb22-513" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-514"><a href="#cb22-514" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add hover text messages</span></span>
<span id="cb22-515"><a href="#cb22-515" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-516"><a href="#cb22-516" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-517"><a href="#cb22-517" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="fu">round</span>(error, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb22-518"><a href="#cb22-518" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-519"><a href="#cb22-519" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb22-520"><a href="#cb22-520" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb22-521"><a href="#cb22-521" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-522"><a href="#cb22-522" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb22-523"><a href="#cb22-523" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb22-524"><a href="#cb22-524" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb22-525"><a href="#cb22-525" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-526"><a href="#cb22-526" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb22-527"><a href="#cb22-527" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>y.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb22-528"><a href="#cb22-528" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb22-529"><a href="#cb22-529" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-530"><a href="#cb22-530" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb22-531"><a href="#cb22-531" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>error, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb22-532"><a href="#cb22-532" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb22-533"><a href="#cb22-533" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb22-534"><a href="#cb22-534" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb22-535"><a href="#cb22-535" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb22-536"><a href="#cb22-536" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-537"><a href="#cb22-537" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb22-538"><a href="#cb22-538" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, N, <span class="st">" trials"</span>),</span>
<span id="cb22-539"><a href="#cb22-539" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb22-540"><a href="#cb22-540" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb22-541"><a href="#cb22-541" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb22-542"><a href="#cb22-542" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shapes =</span> <span class="fu">list</span>(<span class="fu">vline</span>(Z<span class="fl">.95</span>), <span class="fu">vline</span>(Z<span class="fl">.99</span>)),</span>
<span id="cb22-543"><a href="#cb22-543" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb22-544"><a href="#cb22-544" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb22-545"><a href="#cb22-545" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure object</span></span>
<span id="cb22-546"><a href="#cb22-546" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb22-547"><a href="#cb22-547" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb22-548"><a href="#cb22-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-549"><a href="#cb22-549" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 0.1%</span></span>
<span id="cb22-550"><a href="#cb22-550" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.001</span>, <span class="dv">5000</span>)</span>
<span id="cb22-551"><a href="#cb22-551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-552"><a href="#cb22-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-553"><a href="#cb22-553" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1%</span></span>
<span id="cb22-554"><a href="#cb22-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-557"><a href="#cb22-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-558"><a href="#cb22-558" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 1%</span></span>
<span id="cb22-559"><a href="#cb22-559" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.01</span>, <span class="dv">500</span>)</span>
<span id="cb22-560"><a href="#cb22-560" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-561"><a href="#cb22-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-562"><a href="#cb22-562" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10%</span></span>
<span id="cb22-563"><a href="#cb22-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-566"><a href="#cb22-566" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-567"><a href="#cb22-567" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb22-568"><a href="#cb22-568" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.1</span>, <span class="dv">50</span>)</span>
<span id="cb22-569"><a href="#cb22-569" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-570"><a href="#cb22-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-571"><a href="#cb22-571" aria-hidden="true" tabindex="-1"></a><span class="fu">## 20%</span></span>
<span id="cb22-572"><a href="#cb22-572" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-575"><a href="#cb22-575" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-576"><a href="#cb22-576" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb22-577"><a href="#cb22-577" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.2</span>, <span class="dv">25</span>)</span>
<span id="cb22-578"><a href="#cb22-578" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-579"><a href="#cb22-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-580"><a href="#cb22-580" aria-hidden="true" tabindex="-1"></a><span class="fu">## 50%</span></span>
<span id="cb22-581"><a href="#cb22-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-584"><a href="#cb22-584" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-585"><a href="#cb22-585" aria-hidden="true" tabindex="-1"></a><span class="co"># plot example for 10%</span></span>
<span id="cb22-586"><a href="#cb22-586" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotCumProbs</span>(<span class="fl">0.5</span>, <span class="dv">10</span>)</span>
<span id="cb22-587"><a href="#cb22-587" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-588"><a href="#cb22-588" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb22-589"><a href="#cb22-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-590"><a href="#cb22-590" aria-hidden="true" tabindex="-1"></a>When running statistical tests, probabilities calculated at large Z values will be very similiar to both m </span>
<span id="cb22-591"><a href="#cb22-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-592"><a href="#cb22-592" aria-hidden="true" tabindex="-1"></a><span class="fu">## Min. sample size</span></span>
<span id="cb22-593"><a href="#cb22-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-594"><a href="#cb22-594" aria-hidden="true" tabindex="-1"></a>Finally let's investigate for different probabilities how much $p_1$ and $ratio_1$ are affected as sample size is increased.</span>
<span id="cb22-595"><a href="#cb22-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-596"><a href="#cb22-596" aria-hidden="true" tabindex="-1"></a>Now let's investigate how these probabilities and errors change as sample size is increased and "success-failure" condition is met.</span>
<span id="cb22-597"><a href="#cb22-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-600"><a href="#cb22-600" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb22-601"><a href="#cb22-601" aria-hidden="true" tabindex="-1"></a><span class="co"># generate data.table</span></span>
<span id="cb22-602"><a href="#cb22-602" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-603"><a href="#cb22-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb22-604"><a href="#cb22-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-605"><a href="#cb22-605" aria-hidden="true" tabindex="-1"></a><span class="fu">## Conclusions</span></span>
<span id="cb22-606"><a href="#cb22-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-607"><a href="#cb22-607" aria-hidden="true" tabindex="-1"></a>One should be very mindful when designing experiments for one-sample binomial test. Failing to meet "success-failure" condition would result in overestimation or underestimation of you $H_0$ hypothesis results.</span>
<span id="cb22-608"><a href="#cb22-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-609"><a href="#cb22-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-610"><a href="#cb22-610" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb22-611"><a href="#cb22-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-612"><a href="#cb22-612" aria-hidden="true" tabindex="-1"></a>Content for this blog post was prepared using following references:</span>
<span id="cb22-613"><a href="#cb22-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-614"><a href="#cb22-614" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://statistics.laerd.com/spss-tutorials/binomial-test-using-spss-statistics.php</span>
<span id="cb22-615"><a href="#cb22-615" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>http://mlwiki.org/index.php/Binomial_Proportion_Tests</span>
<span id="cb22-616"><a href="#cb22-616" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://sites.ualberta.ca/\~lkgray/uploads/7/3/6/2/7362679/slides\_-\_binomialproportionaltests.pdf</span>
<span id="cb22-617"><a href="#cb22-617" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.technologynetworks.com/informatics/articles/the-binomial-test-366022</span>
<span id="cb22-618"><a href="#cb22-618" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://towardsdatascience.com/turning-a-two-sample-event-rate-test-into-a-one-sample-binomial-test-23fbfb9d1df6</span>
<span id="cb22-619"><a href="#cb22-619" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.studysmarter.us/explanations/math/statistics/binomial-hypothesis-test/</span>
<span id="cb22-620"><a href="#cb22-620" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.statology.org/success-failure-condition/</span>
<span id="cb22-621"><a href="#cb22-621" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://towardsdatascience.com/bernoulli-and-binomial-random-variables-d0698288dd36</span>
<span id="cb22-622"><a href="#cb22-622" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://ubc-mds.github.io/DSCI_551_stat-prob-dsci/lectures/simulation.html</span>
<span id="cb22-623"><a href="#cb22-623" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://math.stackexchange.com/questions/1978138/probability-of-x-red-balls-when-drawing-y-balls-from-a-red-and-b-green-balls</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>
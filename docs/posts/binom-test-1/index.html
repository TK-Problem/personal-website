<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Tomas Kristijonas Uždavinys">
<meta name="dcterms.date" content="2023-03-19">

<title>Tomas Kristijonas Uždavinys - One-Sample Binomial Test (Part 1)</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>
<script src="../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js"></script>
<script src="../../site_libs/plotly-binding-4.10.1/plotly.js"></script>
<script src="../../site_libs/typedarray-0.1/typedarray.min.js"></script>
<script src="../../site_libs/jquery-3.5.1/jquery.min.js"></script>
<link href="../../site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="../../site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<link href="../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">
<script src="../../site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Tomas Kristijonas Uždavinys</span>
    </a>
  </div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html">
 <span class="menu-text">About</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../portfolio.html">
 <span class="menu-text">Portfolio</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../blog.html">
 <span class="menu-text">Blog</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<header id="title-block-header" class="quarto-title-block default page-columns page-full">
  <div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title">One-Sample Binomial Test (Part 1)</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
                                <div class="quarto-categories">
                <div class="quarto-category">R</div>
                <div class="quarto-category">Python</div>
                <div class="quarto-category">Statistics</div>
              </div>
                  </div>
  </div>
    
  
  <div class="quarto-title-meta">

      <div>
      <div class="quarto-title-meta-heading">Author</div>
      <div class="quarto-title-meta-contents">
               <p>Tomas Kristijonas Uždavinys </p>
            </div>
    </div>
      
      <div>
      <div class="quarto-title-meta-heading">Published</div>
      <div class="quarto-title-meta-contents">
        <p class="date">March 19, 2023</p>
      </div>
    </div>
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content">




<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<p>The binomial test is a statistical test used to determine whether the proportion of cases in one of only two categories is equivalent to a pre-specified proportion. Categories could include the default rate of clients within the next 12 months, patients with high or low risk of heart disease, potential customers who are likely or not likely to make a purchase, or the rate of manufacturing defects. This widely used test finds applications in diverse fields, including credit risk, medicine, and manufacturing. It is also known to as the <strong>one-sample proportion test</strong> or <strong>test of one proportion</strong>.</p>
<p>As with all statistical tests, the binomial test has assumptions and conditions that must be met before applying it to real-life data:</p>
<ul>
<li>The “success-failure” condition requires observing a minimum of <strong>n</strong> successes and <strong>n</strong> failures in the sample;</li>
<li>observations are independent, i.e.&nbsp;the occurrence of one event does not affect the probability of occurrence of the other.</li>
</ul>
<p>The aim of this blog post is to showcase the ramifications of failing to meet “success-failure” condition critereon. Practical examples are coded in both <code>R</code> and <code>Python</code> languages.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries for blog post</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="co"># set style</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"ggplot"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="theory" class="level2">
<h2 class="anchored" data-anchor-id="theory">Theory</h2>
<p>Suppose that we have a sample where outcomes are binary - e.g.&nbsp;only “success” and “failure”. For the given sample, we would like to estimate the true proportion and also set up a statistical test to verify whether if the proportion is equal to some value, e.g.&nbsp;expected.</p>
<p>First, we calculate a point estimate:</p>
<p><span class="math display">\[p = \frac{n_s}{n}\]</span></p>
<p>, where <span class="math inline">\(n\)</span> - sample size and <span class="math inline">\(n_s\)</span> - the number of successful observations (or it can be the number of failures).</p>
<p><span class="math display">\[SE = \sqrt{\frac{p \cdot (1 - p)}{n}}\]</span> , where <span class="math inline">\(SE\)</span> is standard error. To perform a test, one first needs to derive a Null hypothesis:</p>
<p><span class="math display">\[H_0: p = p_0\]</span></p>
<p>and an alternative hypothesis:</p>
<ul>
<li>one-sided <span class="math inline">\(H_A: p &lt; p_0\)</span> or <span class="math inline">\(H_A: p &gt; p_0\)</span>,</li>
<li>two-sided <span class="math inline">\(H_A: p \ne p_0\)</span>.</li>
</ul>
<p>Finally, we needs to calculate <span class="math inline">\(Z\)</span> statistics:</p>
<p><span class="math display">\[Z = \frac{p_0-p}{SE}\]</span></p>
<p>Obtaining the value of <span class="math inline">\(Z\)</span> enables us to either compute confidence intervals (<span class="math inline">\(CI\)</span>) or reject <span class="math inline">\(H_0\)</span> in favor of <span class="math inline">\(H_A\)</span></p>
</section>
<section id="success-failure-condition" class="level2">
<h2 class="anchored" data-anchor-id="success-failure-condition">“Success-failure” condition</h2>
<p>In order to approximate any distribution as normal, the mean (<span class="math inline">\(\mu\)</span>) and standard deviation (<span class="math inline">\(\sigma\)</span>) must be known/calculated. For the Binomial distribution comprising <span class="math inline">\(n\)</span> experiments and a probability of <span class="math inline">\(p\)</span> normal distribution mean will be located at:</p>
<p>To approximate any distribution as normal, it is imperative to calculate the mean (<span class="math inline">\(\mu\)</span>) and standard deviation (<span class="math inline">\(\sigma\)</span>). For the Binomial distribution, which consists of a number of experiments <span class="math inline">\(n\)</span> and a probability <span class="math inline">\(p\)</span>, the mean of the normal distribution is:</p>
<p><span class="math display">\[\mu = n \cdot p\]</span></p>
<p>and the standard deviation:</p>
<p><span class="math display">\[\sigma = \sqrt{n \cdot p \cdot (1 - p)}.\]</span></p>
<p>Meeting the “Success-Failure” condition is crucial to approximate Binomial distribution as Normal. Below, I present an instance of 50 Binomial events with varying probability rates of 5%, 30%, and 90%.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">binomial vs.&nbsp;normal (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">error (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">binomial vs.&nbsp;normal (Python)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">error (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">CJ</span>(p, x)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a><span class="co"># add size column</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>dt[, size <span class="sc">:</span><span class="er">=</span> <span class="dv">50</span>]</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="co"># add binomial probability</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>dt[, Binomial <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a><span class="co"># create label column</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">"Prob: "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"%, exp. successes "</span>, <span class="fu">round</span>(p<span class="sc">*</span>size),</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" exp. failures "</span>, <span class="fu">round</span>((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>size))]</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> size <span class="sc">*</span> p]</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>dt[, st.dev <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> size)]</span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>dt[, Normal <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>mu, <span class="at">sd =</span> st.dev) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to ordered factor</span></span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(label, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Prob: 5%, exp. successes 2 exp. failures 48"</span>,</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 30%, exp. successes 15 exp. failures 35"</span>,</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 90%, exp. successes 45 exp. failures 5"</span> ))]</span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape for plotting</span></span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>dt.plot <span class="ot">&lt;-</span> <span class="fu">melt</span>(dt, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"label"</span>),</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"Binomial"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="fu">c</span>(<span class="st">"Type"</span>),</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="fu">c</span>(<span class="st">'prob'</span>))</span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt.plot, <span class="fu">aes</span>(x, prob, <span class="at">color=</span>Type)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Probability, %"</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use data.table from previous code chunk)</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>dt[, Error <span class="sc">:</span><span class="er">=</span> Binomial <span class="sc">-</span> Normal]</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(x, Error)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Error (binom. - norm.), %"</span>)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>]</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">51</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># create DataFrame with all combinations</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> pd.DataFrame({<span class="st">'p'</span>: p})</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>df_2 <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x})</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="co"># create key for joining</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>df_1[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>df_2[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a><span class="co"># perform cross join</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_1.merge(df_2, on<span class="op">=</span><span class="st">'key'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="co"># drop key column</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> df[<span class="st">'key'</span>]</span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add size value</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate binomial probability</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Binomial'</span>] <span class="op">=</span> binom.pmf(df[<span class="st">'x'</span>], df[<span class="st">'size'</span>], df[<span class="st">'p'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mu'</span>] <span class="op">=</span> df[<span class="st">'size'</span>] <span class="op">*</span> df[<span class="st">'p'</span>]</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'se'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">/</span> df[<span class="st">'size'</span>])</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'std'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">*</span> df[<span class="st">'size'</span>])</span>
<span id="cb5-31"><a href="#cb5-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-32"><a href="#cb5-32" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb5-33"><a href="#cb5-33" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Normal'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: norm.pdf(x[<span class="st">'x'</span>], x[<span class="st">'mu'</span>], x[<span class="st">'std'</span>]) <span class="op">*</span> <span class="dv">100</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb5-34"><a href="#cb5-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-35"><a href="#cb5-35" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb5-36"><a href="#cb5-36" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb5-37"><a href="#cb5-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-38"><a href="#cb5-38" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p].copy()</span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Binomial'</span>], <span class="st">"o"</span>, label<span class="op">=</span><span class="st">'Binomial'</span>)<span class="op">;</span></span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Normal'</span>], <span class="st">"-"</span>, label<span class="op">=</span><span class="st">'Normal'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)<span class="op">;</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend and white background</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>legend <span class="op">=</span> ax[<span class="dv">1</span>].legend(frameon <span class="op">=</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> legend.get_frame()<span class="op">;</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>frame.set_color(<span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use DataFrame from previous code chunk)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Error'</span>] <span class="op">=</span> df.Binomial <span class="op">-</span> df.Normal</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p]</span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Error'</span>], <span class="st">"o"</span>, color<span class="op">=</span><span class="st">'k'</span>, markersize<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust limits for better readability</span></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">4.9</span>, <span class="fl">4.9</span>)</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>(-4.9, 4.9)</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="index_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
</div>
</div>
</div>
<p>The first thing to notice is that the “Success-Failure” criterion is only met for the p=30% case. In tabs <code>error</code> one can see that approximation error, i.e.&nbsp;the difference between Binomial probability and Normal distribution approximations, is above 2% for the <span class="math inline">\(p=5\%\)</span> and <span class="math inline">\(p=90\%\)</span> examples.</p>
</section>
<section id="estimating-approximation-error" class="level2">
<h2 class="anchored" data-anchor-id="estimating-approximation-error">Estimating approximation error</h2>
<p>There are a different way to calculate approximation error dependence on sample size. Let’s establish 3 types of probabilities:</p>
<ul>
<li><span class="math inline">\(p_1\)</span> we would observe more than expected number of occurrences,</li>
<li><span class="math inline">\(p_2\)</span> we would observe expected number of occurrences,</li>
<li><span class="math inline">\(p_3\)</span> we would observe less than expected number of occurrences.</li>
</ul>
<p>We have to be mindful, when comparing discrete binomial distribution with a continuous normal distribution. In examples bellow, we can compare areas under the curve for both distributions using interactive charts by <code>plotly</code> library/package. First I create a function to visualize both pint cand cumulative probabilities using interactive charts.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">plot_ly function (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">plotly function (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>PlotDistributions <span class="ot">&lt;-</span> <span class="cf">function</span>(prob, size){</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(size<span class="sc">*</span>prob<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>prob) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>size <span class="sc">*</span> prob, <span class="at">sd =</span> <span class="fu">sqrt</span>(prob <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob) <span class="sc">*</span> size)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data table for plotting</span></span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x,</span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.binom =</span> y.binom,</span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.norm =</span> y.norm)</span>
<span id="cb9-13"><a href="#cb9-13" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-14"><a href="#cb9-14" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns with hover information</span></span>
<span id="cb9-15"><a href="#cb9-15" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-16"><a href="#cb9-16" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-17"><a href="#cb9-17" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-18"><a href="#cb9-18" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-19"><a href="#cb9-19" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate error&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb9-20"><a href="#cb9-20" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom <span class="sc">-</span> y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb9-21"><a href="#cb9-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb9-22"><a href="#cb9-22" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb9-23"><a href="#cb9-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-24"><a href="#cb9-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb9-25"><a href="#cb9-25" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb9-26"><a href="#cb9-26" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb9-27"><a href="#cb9-27" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-28"><a href="#cb9-28" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb9-29"><a href="#cb9-29" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb9-30"><a href="#cb9-30" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb9-31"><a href="#cb9-31" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-32"><a href="#cb9-32" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb9-33"><a href="#cb9-33" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>(prob.binom<span class="sc">-</span>prob.norm), <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb9-34"><a href="#cb9-34" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb9-35"><a href="#cb9-35" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb9-36"><a href="#cb9-36" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb9-37"><a href="#cb9-37" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb9-38"><a href="#cb9-38" aria-hidden="true" tabindex="-1"></a>                           <span class="at">visible =</span> <span class="st">"legendonly"</span>) </span>
<span id="cb9-39"><a href="#cb9-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb9-40"><a href="#cb9-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb9-41"><a href="#cb9-41" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(prob<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, size, <span class="st">" trials"</span>),</span>
<span id="cb9-42"><a href="#cb9-42" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb9-43"><a href="#cb9-43" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb9-44"><a href="#cb9-44" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb9-45"><a href="#cb9-45" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb9-46"><a href="#cb9-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure</span></span>
<span id="cb9-47"><a href="#cb9-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb9-48"><a href="#cb9-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create function for plotting distributions</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_distributions(prob, size):</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> np.arange(<span class="bu">int</span>(size<span class="op">*</span>prob<span class="op">*</span><span class="dv">3</span>))</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a>  y_binom <span class="op">=</span> binom.pmf(x, n<span class="op">=</span>size, p<span class="op">=</span>prob) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate variance and sigma</span></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  variance <span class="op">=</span> size <span class="op">*</span> prob <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> prob)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> np.sqrt(variance)</span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a>  y_norm <span class="op">=</span> norm.pdf(x, loc <span class="op">=</span> size <span class="op">*</span> prob, scale <span class="op">=</span> sigma) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate Data.Frame</span></span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'binom'</span>: y_binom, <span class="st">'norm'</span>: y_norm})</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb10-19"><a href="#cb10-19" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'error'</span>] <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb10-20"><a href="#cb10-20" aria-hidden="true" tabindex="-1"></a>  error <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb10-21"><a href="#cb10-21" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-22"><a href="#cb10-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate hover messages</span></span>
<span id="cb10-23"><a href="#cb10-23" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_1'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"binom"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-24"><a href="#cb10-24" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_2'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"norm"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-25"><a href="#cb10-25" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_3'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate error&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"error"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb10-26"><a href="#cb10-26" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb10-27"><a href="#cb10-27" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb10-28"><a href="#cb10-28" aria-hidden="true" tabindex="-1"></a>  fig <span class="op">=</span> go.Figure()</span>
<span id="cb10-29"><a href="#cb10-29" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_norm, text <span class="op">=</span> df[<span class="st">'text_1'</span>].values,</span>
<span id="cb10-30"><a href="#cb10-30" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Normal'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-31"><a href="#cb10-31" aria-hidden="true" tabindex="-1"></a>                           line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FF6666'</span>, width<span class="op">=</span><span class="dv">5</span>)))</span>
<span id="cb10-32"><a href="#cb10-32" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_binom, text <span class="op">=</span> df[<span class="st">'text_2'</span>].values,</span>
<span id="cb10-33"><a href="#cb10-33" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Binomial'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-34"><a href="#cb10-34" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#3399FF'</span>, size<span class="op">=</span><span class="dv">12</span>)))</span>
<span id="cb10-35"><a href="#cb10-35" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>error, text <span class="op">=</span> df[<span class="st">'text_3'</span>].values,</span>
<span id="cb10-36"><a href="#cb10-36" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Error'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb10-37"><a href="#cb10-37" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb10-38"><a href="#cb10-38" aria-hidden="true" tabindex="-1"></a>                           visible <span class="op">=</span> <span class="st">"legendonly"</span>))</span>
<span id="cb10-39"><a href="#cb10-39" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb10-40"><a href="#cb10-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit the layout</span></span>
<span id="cb10-41"><a href="#cb10-41" aria-hidden="true" tabindex="-1"></a>  fig.update_layout(title<span class="op">=</span><span class="ss">f"p = </span><span class="sc">{</span>prob<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%, </span><span class="sc">{</span>size<span class="sc">}</span><span class="ss"> trials"</span>,</span>
<span id="cb10-42"><a href="#cb10-42" aria-hidden="true" tabindex="-1"></a>                    xaxis_title<span class="op">=</span><span class="st">'Observations'</span>,</span>
<span id="cb10-43"><a href="#cb10-43" aria-hidden="true" tabindex="-1"></a>                    yaxis_title<span class="op">=</span><span class="st">'Probability, %'</span>,</span>
<span id="cb10-44"><a href="#cb10-44" aria-hidden="true" tabindex="-1"></a>                    template<span class="op">=</span><span class="st">"ggplot2"</span>,</span>
<span id="cb10-45"><a href="#cb10-45" aria-hidden="true" tabindex="-1"></a>                    hovermode<span class="op">=</span><span class="st">"x unified"</span>)</span>
<span id="cb10-46"><a href="#cb10-46" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb10-47"><a href="#cb10-47" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
<p>Next I provide examples using different probabilities.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">5% (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">1% (R)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">0.5% (Python)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">0.0=1% (Python)</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.05</span>, <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-6fe294e099b0534e6250" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6fe294e099b0534e6250">{"x":{"visdat":{"79b869b41f57":["function () ","plotlyVisDat"]},"cur_data":"79b869b41f57","attrs":{"79b869b41f57":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"79b869b41f57.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"79b869b41f57.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"79b869b41f57.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"visible":"legendonly","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 5%, 200 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[0.0670328727901055,0.18221424001475,0.445822093895711,0.981805932463231,1.94614192230615,3.47222736441273,5.57604916305069,8.0599031712503,10.4861929812999,12.2797820542076,12.9433967351735,12.2797820542076,10.4861929812999,8.0599031712503,5.57604916305069,3.47222736441273,1.94614192230615,0.981805932463231,0.445822093895711,0.18221424001475,0.0670328727901055,0.02219617506869,0.00661535633632494,0.00177465172136058,0.000428506898786581,9.31295047129722e-05,1.82180361553969e-05,3.20775076620961e-06,5.08375329046751e-07,7.25192171174615e-08,9.31121894676173e-09],"text":["Point estimate probability<br>to observer exactly 0 events is 0.004%","Point estimate probability<br>to observer exactly 1 events is 0.037%","Point estimate probability<br>to observer exactly 2 events is 0.193%","Point estimate probability<br>to observer exactly 3 events is 0.671%","Point estimate probability<br>to observer exactly 4 events is 1.74%","Point estimate probability<br>to observer exactly 5 events is 3.59%","Point estimate probability<br>to observer exactly 6 events is 6.14%","Point estimate probability<br>to observer exactly 7 events is 8.956%","Point estimate probability<br>to observer exactly 8 events is 11.372%","Point estimate probability<br>to observer exactly 9 events is 12.769%","Point estimate probability<br>to observer exactly 10 events is 12.836%","Point estimate probability<br>to observer exactly 11 events is 11.669%","Point estimate probability<br>to observer exactly 12 events is 9.673%","Point estimate probability<br>to observer exactly 13 events is 7.362%","Point estimate probability<br>to observer exactly 14 events is 5.176%","Point estimate probability<br>to observer exactly 15 events is 3.378%","Point estimate probability<br>to observer exactly 16 events is 2.056%","Point estimate probability<br>to observer exactly 17 events is 1.171%","Point estimate probability<br>to observer exactly 18 events is 0.627%","Point estimate probability<br>to observer exactly 19 events is 0.316%","Point estimate probability<br>to observer exactly 20 events is 0.15%","Point estimate probability<br>to observer exactly 21 events is 0.068%","Point estimate probability<br>to observer exactly 22 events is 0.029%","Point estimate probability<br>to observer exactly 23 events is 0.012%","Point estimate probability<br>to observer exactly 24 events is 0.005%","Point estimate probability<br>to observer exactly 25 events is 0.002%","Point estimate probability<br>to observer exactly 26 events is 0.001%","Point estimate probability<br>to observer exactly 27 events is 0%","Point estimate probability<br>to observer exactly 28 events is 0%","Point estimate probability<br>to observer exactly 29 events is 0%","Point estimate probability<br>to observer exactly 30 events is 0%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[0.00350526662488291,0.03689754341982,0.193226608961689,0.671208220603762,1.73984236130186,3.58956950331752,6.14005309777996,8.956167676461,11.3719760628748,12.7685345267366,12.8357373400352,11.6688521273048,9.67286426342369,7.36234203046013,5.1757818033686,3.3778786506195,2.05561694198884,1.17100160162832,0.62658857630989,0.315897841796123,0.150467129908153,0.0678799082292418,0.0290681903661107,0.0118401324603381,0.00459584088921016,0.00170287999263365,0.000603246960953217,0.000204610080323315,6.65367366464911e-05,2.07700883905563e-05,6.23102651716686e-06],"text":["Point estimate probability<br>to observer exactly 0 events is 0.067%","Point estimate probability<br>to observer exactly 1 events is 0.182%","Point estimate probability<br>to observer exactly 2 events is 0.446%","Point estimate probability<br>to observer exactly 3 events is 0.982%","Point estimate probability<br>to observer exactly 4 events is 1.946%","Point estimate probability<br>to observer exactly 5 events is 3.472%","Point estimate probability<br>to observer exactly 6 events is 5.576%","Point estimate probability<br>to observer exactly 7 events is 8.06%","Point estimate probability<br>to observer exactly 8 events is 10.486%","Point estimate probability<br>to observer exactly 9 events is 12.28%","Point estimate probability<br>to observer exactly 10 events is 12.943%","Point estimate probability<br>to observer exactly 11 events is 12.28%","Point estimate probability<br>to observer exactly 12 events is 10.486%","Point estimate probability<br>to observer exactly 13 events is 8.06%","Point estimate probability<br>to observer exactly 14 events is 5.576%","Point estimate probability<br>to observer exactly 15 events is 3.472%","Point estimate probability<br>to observer exactly 16 events is 1.946%","Point estimate probability<br>to observer exactly 17 events is 0.982%","Point estimate probability<br>to observer exactly 18 events is 0.446%","Point estimate probability<br>to observer exactly 19 events is 0.182%","Point estimate probability<br>to observer exactly 20 events is 0.067%","Point estimate probability<br>to observer exactly 21 events is 0.022%","Point estimate probability<br>to observer exactly 22 events is 0.007%","Point estimate probability<br>to observer exactly 23 events is 0.002%","Point estimate probability<br>to observer exactly 24 events is 0%","Point estimate probability<br>to observer exactly 25 events is 0%","Point estimate probability<br>to observer exactly 26 events is 0%","Point estimate probability<br>to observer exactly 27 events is 0%","Point estimate probability<br>to observer exactly 28 events is 0%","Point estimate probability<br>to observer exactly 29 events is 0%","Point estimate probability<br>to observer exactly 30 events is 0%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],"y":[-0.0635276061652226,-0.14531669659493,-0.252595484934021,-0.310597711859468,-0.206299561004297,0.117342138904788,0.56400393472927,0.896264505210702,0.885783081574868,0.488752472529013,-0.107659395138267,-0.610929926902848,-0.813328717876255,-0.697561140790167,-0.400267359682092,-0.0943487137932291,0.109475019682683,0.189195669165088,0.18076648241418,0.133683601781372,0.0834342571180471,0.0456837331605518,0.0224528340297857,0.0100654807389775,0.00416733399042358,0.00160975048792068,0.00058502892479782,0.000201402329557105,6.60283613174443e-05,2.06975691734389e-05,6.2217152982201e-06],"text":["Point estimate error<br>to observer exactly 0 events is -0.064%","Point estimate error<br>to observer exactly 1 events is -0.145%","Point estimate error<br>to observer exactly 2 events is -0.253%","Point estimate error<br>to observer exactly 3 events is -0.311%","Point estimate error<br>to observer exactly 4 events is -0.206%","Point estimate error<br>to observer exactly 5 events is 0.117%","Point estimate error<br>to observer exactly 6 events is 0.564%","Point estimate error<br>to observer exactly 7 events is 0.896%","Point estimate error<br>to observer exactly 8 events is 0.886%","Point estimate error<br>to observer exactly 9 events is 0.489%","Point estimate error<br>to observer exactly 10 events is -0.108%","Point estimate error<br>to observer exactly 11 events is -0.611%","Point estimate error<br>to observer exactly 12 events is -0.813%","Point estimate error<br>to observer exactly 13 events is -0.698%","Point estimate error<br>to observer exactly 14 events is -0.4%","Point estimate error<br>to observer exactly 15 events is -0.094%","Point estimate error<br>to observer exactly 16 events is 0.109%","Point estimate error<br>to observer exactly 17 events is 0.189%","Point estimate error<br>to observer exactly 18 events is 0.181%","Point estimate error<br>to observer exactly 19 events is 0.134%","Point estimate error<br>to observer exactly 20 events is 0.083%","Point estimate error<br>to observer exactly 21 events is 0.046%","Point estimate error<br>to observer exactly 22 events is 0.022%","Point estimate error<br>to observer exactly 23 events is 0.01%","Point estimate error<br>to observer exactly 24 events is 0.004%","Point estimate error<br>to observer exactly 25 events is 0.002%","Point estimate error<br>to observer exactly 26 events is 0.001%","Point estimate error<br>to observer exactly 27 events is 0%","Point estimate error<br>to observer exactly 28 events is 0%","Point estimate error<br>to observer exactly 29 events is 0%","Point estimate error<br>to observer exactly 30 events is 0%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"visible":"legendonly","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.01</span>, <span class="dv">500</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-df6591341786eecd3311" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-df6591341786eecd3311">{"x":{"visdat":{"79b8521c6ae3":["function () ","plotlyVisDat"]},"cur_data":"79b8521c6ae3","attrs":{"79b8521c6ae3":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"79b8521c6ae3.1":{"mode":"lines","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Normal","hoverinfo":"text","line":{"color":"#FF6666","width":5},"inherit":true},"79b8521c6ae3.2":{"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Binomial","hoverinfo":"text","marker":{"color":"#3399FF","size":12},"inherit":true},"79b8521c6ae3.3":{"mode":"lines+markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter","x":{},"y":{},"text":{},"name":"Error","hoverinfo":"text","line":{"color":"black","width":5},"marker":{"color":"black","size":12},"visible":"legendonly","inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"p = 1%, 500 trials","xaxis":{"domain":[0,1],"automargin":true,"title":"Observations"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Probability, %"},"hovermode":"x unified","legend":{"title":{"text":"<b> Distributions <\/b>"}},"showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"mode":"lines","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[1.4351729136086,3.56219257926459,7.22427552346719,11.9711245251861,16.2083698055689,17.9311220384945,16.2083698055689,11.9711245251861,7.22427552346719,3.56219257926459,1.4351729136086,0.472448859451793,0.127077634374317,0.0279284722392723,0.00501520832864651,0.000735858850737212],"text":["Point estimate probability<br>to observer exactly 0 events is 0.657%","Point estimate probability<br>to observer exactly 1 events is 3.318%","Point estimate probability<br>to observer exactly 2 events is 8.363%","Point estimate probability<br>to observer exactly 3 events is 14.023%","Point estimate probability<br>to observer exactly 4 events is 17.6%","Point estimate probability<br>to observer exactly 5 events is 17.635%","Point estimate probability<br>to observer exactly 6 events is 14.696%","Point estimate probability<br>to observer exactly 7 events is 10.476%","Point estimate probability<br>to observer exactly 8 events is 6.521%","Point estimate probability<br>to observer exactly 9 events is 3.601%","Point estimate probability<br>to observer exactly 10 events is 1.786%","Point estimate probability<br>to observer exactly 11 events is 0.804%","Point estimate probability<br>to observer exactly 12 events is 0.331%","Point estimate probability<br>to observer exactly 13 events is 0.125%","Point estimate probability<br>to observer exactly 14 events is 0.044%","Point estimate probability<br>to observer exactly 15 events is 0.014%"],"name":"Normal","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"#FF6666","width":5},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[0.657048304241463,3.31842577899729,8.36310335211943,14.0229813783013,17.5995498611508,17.635104507335,14.6959204227791,10.4758797818945,6.52097062181059,3.60080532652168,1.78585395487085,0.803552284560806,0.330755107028817,0.125414523877282,0.0440670080290307,0.01442192990041],"text":["Point estimate probability<br>to observer exactly 0 events is 1.435%","Point estimate probability<br>to observer exactly 1 events is 3.562%","Point estimate probability<br>to observer exactly 2 events is 7.224%","Point estimate probability<br>to observer exactly 3 events is 11.971%","Point estimate probability<br>to observer exactly 4 events is 16.208%","Point estimate probability<br>to observer exactly 5 events is 17.931%","Point estimate probability<br>to observer exactly 6 events is 16.208%","Point estimate probability<br>to observer exactly 7 events is 11.971%","Point estimate probability<br>to observer exactly 8 events is 7.224%","Point estimate probability<br>to observer exactly 9 events is 3.562%","Point estimate probability<br>to observer exactly 10 events is 1.435%","Point estimate probability<br>to observer exactly 11 events is 0.472%","Point estimate probability<br>to observer exactly 12 events is 0.127%","Point estimate probability<br>to observer exactly 13 events is 0.028%","Point estimate probability<br>to observer exactly 14 events is 0.005%","Point estimate probability<br>to observer exactly 15 events is 0.001%"],"name":"Binomial","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"marker":{"color":"#3399FF","size":12,"line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"mode":"lines+markers","type":"scatter","x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],"y":[-0.77812460936714,-0.243766800267303,1.13882782865224,2.05185685311514,1.39118005558191,-0.296017531159556,-1.51244938278978,-1.49524474329161,-0.703304901656596,0.0386127472570856,0.350681041262247,0.331103425109013,0.2036774726545,0.09748605163801,0.0390517997003842,0.0136860710496728],"text":["Point estimate error<br>to observer exactly 0 events is -0.778%","Point estimate error<br>to observer exactly 1 events is -0.244%","Point estimate error<br>to observer exactly 2 events is 1.139%","Point estimate error<br>to observer exactly 3 events is 2.052%","Point estimate error<br>to observer exactly 4 events is 1.391%","Point estimate error<br>to observer exactly 5 events is -0.296%","Point estimate error<br>to observer exactly 6 events is -1.512%","Point estimate error<br>to observer exactly 7 events is -1.495%","Point estimate error<br>to observer exactly 8 events is -0.703%","Point estimate error<br>to observer exactly 9 events is 0.039%","Point estimate error<br>to observer exactly 10 events is 0.351%","Point estimate error<br>to observer exactly 11 events is 0.331%","Point estimate error<br>to observer exactly 12 events is 0.204%","Point estimate error<br>to observer exactly 13 events is 0.097%","Point estimate error<br>to observer exactly 14 events is 0.039%","Point estimate error<br>to observer exactly 15 events is 0.014%"],"name":"Error","hoverinfo":["text","text","text","text","text","text","text","text","text","text","text","text","text","text","text","text"],"line":{"color":"black","width":5},"marker":{"color":"black","size":12,"line":{"color":"rgba(214,39,40,1)"}},"visible":"legendonly","error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.2,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.005</span>, <span class="dv">500</span>)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>                <div id="ebda9007-df0d-4db4-b057-28fc2e865c2b" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("ebda9007-df0d-4db4-b057-28fc2e865c2b")) {                    Plotly.newPlot(                        "ebda9007-df0d-4db4-b057-28fc2e865c2b",                        [{"hoverinfo":"text","line":{"color":"#FF6666","width":5},"mode":"lines","name":"Normal","text":["Point estimate probability<br>to observer exactly 0 events is 8.157%","Point estimate probability<br>to observer exactly 1 events is 20.495%","Point estimate probability<br>to observer exactly 2 events is 25.697%","Point estimate probability<br>to observer exactly 3 events is 21.435%","Point estimate probability<br>to observer exactly 4 events is 13.384%","Point estimate probability<br>to observer exactly 5 events is 6.672%","Point estimate probability<br>to observer exactly 6 events is 2.766%"],"x":[0,1,2,3,4,5,6],"y":[7.201657088507865,16.092144782594534,24.05496214528462,24.05496214528462,16.092144782594534,7.201657088507865,2.156056804713043],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"#3399FF","size":12},"mode":"markers","name":"Binomial","text":["Point estimate probability<br>to observer exactly 0 events is 7.202%","Point estimate probability<br>to observer exactly 1 events is 16.092%","Point estimate probability<br>to observer exactly 2 events is 24.055%","Point estimate probability<br>to observer exactly 3 events is 24.055%","Point estimate probability<br>to observer exactly 4 events is 16.092%","Point estimate probability<br>to observer exactly 5 events is 7.202%","Point estimate probability<br>to observer exactly 6 events is 2.156%"],"x":[0,1,2,3,4,5,6],"y":[8.157186144027833,20.4954425729343,25.69654734646788,21.43531085182747,13.383604891153583,6.671626156796161,2.76587516550594],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"black","size":12},"mode":"markers","name":"Error","text":["Point estimate error<br>to observer exactly 0 events is 0.956%","Point estimate error<br>to observer exactly 1 events is 4.403%","Point estimate error<br>to observer exactly 2 events is 1.642%","Point estimate error<br>to observer exactly 3 events is -2.620%","Point estimate error<br>to observer exactly 4 events is -2.709%","Point estimate error<br>to observer exactly 5 events is -0.530%","Point estimate error<br>to observer exactly 6 events is 0.610%"],"visible":"legendonly","x":[0,1,2,3,4,5,6],"y":[0.9555290555199676,4.403297790339767,1.6415852011832612,-2.6196512934571494,-2.7085398914409513,-0.5300309317117042,0.6098183607928971],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"p = 0.5%, 500 trials"},"xaxis":{"title":{"text":"Observations"}},"yaxis":{"title":{"text":"Probability, %"}},"hovermode":"x unified"},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.001</span>, <span class="dv">2000</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>fig</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">

<div>                        <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script src="https://cdn.plot.ly/plotly-2.12.1.min.js"></script>                <div id="41b1e1ec-89ca-4b3f-a644-6bde72ca6865" class="plotly-graph-div" style="height:100%; width:100%;"></div>            <script type="text/javascript">                                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("41b1e1ec-89ca-4b3f-a644-6bde72ca6865")) {                    Plotly.newPlot(                        "41b1e1ec-89ca-4b3f-a644-6bde72ca6865",                        [{"hoverinfo":"text","line":{"color":"#FF6666","width":5},"mode":"lines","name":"Normal","text":["Point estimate probability<br>to observer exactly 0 events is 13.520%","Point estimate probability<br>to observer exactly 1 events is 27.067%","Point estimate probability<br>to observer exactly 2 events is 27.081%","Point estimate probability<br>to observer exactly 3 events is 18.054%","Point estimate probability<br>to observer exactly 4 events is 9.022%","Point estimate probability<br>to observer exactly 5 events is 3.605%"],"x":[0,1,2,3,4,5],"y":[10.372492100767039,21.97505754927657,28.22359450435438,21.97505754927657,10.372492100767039,2.968052638281716],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"#3399FF","size":12},"mode":"markers","name":"Binomial","text":["Point estimate probability<br>to observer exactly 0 events is 10.372%","Point estimate probability<br>to observer exactly 1 events is 21.975%","Point estimate probability<br>to observer exactly 2 events is 28.224%","Point estimate probability<br>to observer exactly 3 events is 21.975%","Point estimate probability<br>to observer exactly 4 events is 10.372%","Point estimate probability<br>to observer exactly 5 events is 2.968%"],"x":[0,1,2,3,4,5],"y":[13.519992539749945,27.067052131631552,27.080599204770518,18.05373280318035,9.022348450438237,3.605326828243184],"type":"scatter"},{"hoverinfo":"text","marker":{"color":"black","size":12},"mode":"markers","name":"Error","text":["Point estimate error<br>to observer exactly 0 events is 3.148%","Point estimate error<br>to observer exactly 1 events is 5.092%","Point estimate error<br>to observer exactly 2 events is -1.143%","Point estimate error<br>to observer exactly 3 events is -3.921%","Point estimate error<br>to observer exactly 4 events is -1.350%","Point estimate error<br>to observer exactly 5 events is 0.637%"],"visible":"legendonly","x":[0,1,2,3,4,5],"y":[3.147500438982906,5.091994582354982,-1.1429952995838626,-3.9213247460962215,-1.3501436503288016,0.637274189961468],"type":"scatter"}],                        {"template":{"data":{"barpolar":[{"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"bar":[{"error_x":{"color":"rgb(51,51,51)"},"error_y":{"color":"rgb(51,51,51)"},"marker":{"line":{"color":"rgb(237,237,237)","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"carpet":[{"aaxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"baxis":{"endlinecolor":"rgb(51,51,51)","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"rgb(51,51,51)"},"type":"carpet"}],"choropleth":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"choropleth"}],"contourcarpet":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"contourcarpet"}],"contour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"contour"}],"heatmapgl":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmapgl"}],"heatmap":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"heatmap"}],"histogram2dcontour":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2dcontour"}],"histogram2d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"histogram2d"}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"mesh3d":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"type":"mesh3d"}],"parcoords":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"parcoords"}],"pie":[{"automargin":true,"type":"pie"}],"scatter3d":[{"line":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatter3d"}],"scattercarpet":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattercarpet"}],"scattergeo":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergeo"}],"scattergl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattergl"}],"scattermapbox":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scattermapbox"}],"scatterpolargl":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolargl"}],"scatterpolar":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterpolar"}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"scatterternary":[{"marker":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"type":"scatterternary"}],"surface":[{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"},"colorscale":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"type":"surface"}],"table":[{"cells":{"fill":{"color":"rgb(237,237,237)"},"line":{"color":"white"}},"header":{"fill":{"color":"rgb(217,217,217)"},"line":{"color":"white"}},"type":"table"}]},"layout":{"annotationdefaults":{"arrowhead":0,"arrowwidth":1},"autotypenumbers":"strict","coloraxis":{"colorbar":{"outlinewidth":0,"tickcolor":"rgb(237,237,237)","ticklen":6,"ticks":"inside"}},"colorscale":{"sequential":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]],"sequentialminus":[[0,"rgb(20,44,66)"],[1,"rgb(90,179,244)"]]},"colorway":["#F8766D","#A3A500","#00BF7D","#00B0F6","#E76BF3"],"font":{"color":"rgb(51,51,51)"},"geo":{"bgcolor":"white","lakecolor":"white","landcolor":"rgb(237,237,237)","showlakes":true,"showland":true,"subunitcolor":"white"},"hoverlabel":{"align":"left"},"hovermode":"closest","paper_bgcolor":"white","plot_bgcolor":"rgb(237,237,237)","polar":{"angularaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","radialaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"scene":{"xaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"yaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"},"zaxis":{"backgroundcolor":"rgb(237,237,237)","gridcolor":"white","gridwidth":2,"linecolor":"white","showbackground":true,"showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","zerolinecolor":"white"}},"shapedefaults":{"fillcolor":"black","line":{"width":0},"opacity":0.3},"ternary":{"aaxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"baxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"},"bgcolor":"rgb(237,237,237)","caxis":{"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside"}},"xaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"},"yaxis":{"automargin":true,"gridcolor":"white","linecolor":"white","showgrid":true,"tickcolor":"rgb(51,51,51)","ticks":"outside","title":{"standoff":15},"zerolinecolor":"white"}}},"title":{"text":"p = 0.1%, 2000 trials"},"xaxis":{"title":{"text":"Observations"}},"yaxis":{"title":{"text":"Probability, %"}},"hovermode":"x unified"},                        {"responsive": true}                    )                };                            </script>        </div>
</div>
</div>
</div>
</div>
</div>
<p>Let’s taken hypothetical model of 1%, i.e.&nbsp;we expect to have 1% manufacturing defects or 1% of clients in our portfolio will fail to meet their credit obligations. For this hypothetical model to meet “Success-Failure” condition we would need to collect at least 1000 observations, i.e.&nbsp;to manufacture 1000 devices or issue credit to 1000 obligatory. Let’s compare 3 probabilities calculated using binomial and normal distribution approximation:</p>
<p>In all 3 cases, we need to calculated expected number of occurrences <span class="math inline">\(n \cdot p\)</span>. Let’s investigate sample sizes raging from 100 to 2000.</p>
<p>From the given example, we can ratios between probabilities for all 3 cases.</p>
<div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">R</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">Python</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector with different sample sizes</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>sampleSizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">2000</span>, <span class="dv">100</span>)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table for p = 0.01, i.e. 1%</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">N =</span> sampleSizes, <span class="at">p =</span> <span class="fl">0.02</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate expected number of observations and standard deviation</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> N <span class="sc">*</span> p]</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>dt[, std <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)]</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probabilities of observing:</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. less than the expected number of observations</span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. exactly the expected number of observations</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. more than the expected number of observations</span></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pbinom</span>(mu<span class="dv">-1</span>, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(mu, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(mu, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a><span class="co"># same but for normal distribution</span></span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pnorm</span>(mu<span class="dv">-1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pnorm</span>(mu<span class="sc">+</span><span class="dv">1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std) <span class="sc">-</span> <span class="fu">pnorm</span>(mu<span class="dv">-1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(mu<span class="sc">+</span><span class="dv">1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate errors</span></span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a>dt[, error.left <span class="sc">:</span><span class="er">=</span> binom<span class="fl">.1</span><span class="sc">/</span>norm<span class="fl">.1</span>]</span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a>dt[, error.right <span class="sc">:</span><span class="er">=</span> binom<span class="fl">.3</span><span class="sc">/</span>norm<span class="fl">.3</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</div>
</div>
</div>
</section>
<section id="independent-observations" class="level2">
<h2 class="anchored" data-anchor-id="independent-observations">Independent observations</h2>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>
<p>Content for this blog post was prepared using following references:</p>
<ul>
<li>https://statistics.laerd.com/spss-tutorials/binomial-test-using-spss-statistics.php</li>
<li>http://mlwiki.org/index.php/Binomial_Proportion_Tests</li>
<li>https://sites.ualberta.ca/~lkgray/uploads/7/3/6/2/7362679/slides_-_binomialproportionaltests.pdf</li>
<li>https://www.technologynetworks.com/informatics/articles/the-binomial-test-366022</li>
<li>https://towardsdatascience.com/turning-a-two-sample-event-rate-test-into-a-one-sample-binomial-test-23fbfb9d1df6</li>
<li>https://www.studysmarter.us/explanations/math/statistics/binomial-hypothesis-test/</li>
<li>https://www.statology.org/success-failure-condition/</li>
<li>https://towardsdatascience.com/bernoulli-and-binomial-random-variables-d0698288dd36</li>
<li>https://ubc-mds.github.io/DSCI_551_stat-prob-dsci/lectures/simulation.html</li>
<li>https://math.stackexchange.com/questions/1978138/probability-of-x-red-balls-when-drawing-y-balls-from-a-red-and-b-green-balls</li>
</ul>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb17" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "One-Sample Binomial Test (Part 1)"</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Tomas Kristijonas Uždavinys"</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "2023-03-19"</span></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="an">draft:</span><span class="co"> false</span></span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span><span class="co"> [R, Python, Statistics]</span></span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Introduction</span></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>The binomial test is a statistical test used to determine whether the proportion of cases in one of only two categories is equivalent to a pre-specified proportion. Categories could include the default rate of clients within the next 12 months, patients with high or low risk of heart disease, potential customers who are likely or not likely to make a purchase, or the rate of manufacturing defects. This widely used test finds applications in diverse fields, including credit risk, medicine, and manufacturing. It is also known to as the **one-sample proportion test** or **test of one proportion**.</span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a>As with all statistical tests, the binomial test has assumptions and conditions that must be met before applying it to real-life data:</span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>The "success-failure" condition requires observing a minimum of **n** successes and **n** failures in the sample;</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>observations are independent, i.e. the occurrence of one event does not affect the probability of occurrence of the other.</span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>The aim of this blog post is to showcase the ramifications of failing to meet "success-failure" condition critereon. Practical examples are coded in both <span class="in">`R`</span> and <span class="in">`Python`</span> languages.</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries for blog post</span></span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plotly)</span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(data.table)</span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.graph_objects <span class="im">as</span> go</span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> binom, norm</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co"># set style</span></span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">"ggplot"</span>)</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="fu">## Theory</span></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a>Suppose that we have a sample where outcomes are binary - e.g. only "success" and "failure". For the given sample, we would like to estimate the true proportion and also set up a statistical test to verify whether if the proportion is equal to some value, e.g. expected.</span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>First, we calculate a point estimate:</span>
<span id="cb17-59"><a href="#cb17-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-60"><a href="#cb17-60" aria-hidden="true" tabindex="-1"></a>$$p = \frac{n_s}{n}$$</span>
<span id="cb17-61"><a href="#cb17-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-62"><a href="#cb17-62" aria-hidden="true" tabindex="-1"></a>, where $n$ - sample size and $n_s$ - the number of successful observations (or it can be the number of failures).</span>
<span id="cb17-63"><a href="#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-64"><a href="#cb17-64" aria-hidden="true" tabindex="-1"></a>$$SE = \sqrt{\frac{p \cdot (1 - p)}{n}}$$</span>
<span id="cb17-65"><a href="#cb17-65" aria-hidden="true" tabindex="-1"></a>, where $SE$ is standard error. To perform a test, one first needs to derive a Null hypothesis:</span>
<span id="cb17-66"><a href="#cb17-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-67"><a href="#cb17-67" aria-hidden="true" tabindex="-1"></a>$$H_0: p = p_0$$</span>
<span id="cb17-68"><a href="#cb17-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-69"><a href="#cb17-69" aria-hidden="true" tabindex="-1"></a>and an alternative hypothesis:</span>
<span id="cb17-70"><a href="#cb17-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-71"><a href="#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>one-sided $H_A: p &lt; p_0$ or $H_A: p &gt; p_0$,</span>
<span id="cb17-72"><a href="#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>two-sided $H_A: p \ne p_0$.</span>
<span id="cb17-73"><a href="#cb17-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-74"><a href="#cb17-74" aria-hidden="true" tabindex="-1"></a>Finally, we needs to calculate $Z$ statistics:</span>
<span id="cb17-75"><a href="#cb17-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-76"><a href="#cb17-76" aria-hidden="true" tabindex="-1"></a>$$Z = \frac{p_0-p}{SE}$$</span>
<span id="cb17-77"><a href="#cb17-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-78"><a href="#cb17-78" aria-hidden="true" tabindex="-1"></a>Obtaining the value of $Z$ enables us to either compute confidence intervals ($CI$) or reject $H_0$ in favor of $H_A$</span>
<span id="cb17-79"><a href="#cb17-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-80"><a href="#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="fu">## “Success-failure” condition</span></span>
<span id="cb17-81"><a href="#cb17-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-82"><a href="#cb17-82" aria-hidden="true" tabindex="-1"></a>In order to approximate any distribution as normal, the mean ($\mu$) and standard deviation ($\sigma$) must be known/calculated. For the Binomial distribution comprising $n$ experiments and a probability of $p$ normal distribution mean will be located at:</span>
<span id="cb17-83"><a href="#cb17-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-84"><a href="#cb17-84" aria-hidden="true" tabindex="-1"></a>To approximate any distribution as normal, it is imperative to calculate the mean ($\mu$) and standard deviation ($\sigma$). For the Binomial distribution, which consists of a number of experiments $n$ and a probability $p$, the mean of the normal distribution is:</span>
<span id="cb17-85"><a href="#cb17-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-86"><a href="#cb17-86" aria-hidden="true" tabindex="-1"></a>$$\mu = n \cdot p$$</span>
<span id="cb17-87"><a href="#cb17-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-88"><a href="#cb17-88" aria-hidden="true" tabindex="-1"></a>and the standard deviation:</span>
<span id="cb17-89"><a href="#cb17-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-90"><a href="#cb17-90" aria-hidden="true" tabindex="-1"></a>$$\sigma = \sqrt{n \cdot p \cdot (1 - p)}.$$</span>
<span id="cb17-91"><a href="#cb17-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-92"><a href="#cb17-92" aria-hidden="true" tabindex="-1"></a>Meeting the "Success-Failure" condition is crucial to approximate Binomial distribution as Normal. Below, I present an instance of 50 Binomial events with varying probability rates of 5%, 30%, and 90%.</span>
<span id="cb17-93"><a href="#cb17-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-94"><a href="#cb17-94" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-95"><a href="#cb17-95" aria-hidden="true" tabindex="-1"></a><span class="fu">## binomial vs. normal (R)</span></span>
<span id="cb17-96"><a href="#cb17-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-99"><a href="#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-100"><a href="#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb17-101"><a href="#cb17-101" aria-hidden="true" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>)</span>
<span id="cb17-102"><a href="#cb17-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-103"><a href="#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb17-104"><a href="#cb17-104" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb17-105"><a href="#cb17-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-106"><a href="#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table</span></span>
<span id="cb17-107"><a href="#cb17-107" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">CJ</span>(p, x)</span>
<span id="cb17-108"><a href="#cb17-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-109"><a href="#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="co"># add size column</span></span>
<span id="cb17-110"><a href="#cb17-110" aria-hidden="true" tabindex="-1"></a>dt[, size <span class="sc">:</span><span class="er">=</span> <span class="dv">50</span>]</span>
<span id="cb17-111"><a href="#cb17-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-112"><a href="#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="co"># add binomial probability</span></span>
<span id="cb17-113"><a href="#cb17-113" aria-hidden="true" tabindex="-1"></a>dt[, Binomial <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>p) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb17-114"><a href="#cb17-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-115"><a href="#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="co"># create label column</span></span>
<span id="cb17-116"><a href="#cb17-116" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">"Prob: "</span>, <span class="fu">round</span>(p<span class="sc">*</span><span class="dv">100</span>),</span>
<span id="cb17-117"><a href="#cb17-117" aria-hidden="true" tabindex="-1"></a>                     <span class="st">"%, exp. successes "</span>, <span class="fu">round</span>(p<span class="sc">*</span>size),</span>
<span id="cb17-118"><a href="#cb17-118" aria-hidden="true" tabindex="-1"></a>                     <span class="st">" exp. failures "</span>, <span class="fu">round</span>((<span class="dv">1</span><span class="sc">-</span>p)<span class="sc">*</span>size))]</span>
<span id="cb17-119"><a href="#cb17-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-120"><a href="#cb17-120" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb17-121"><a href="#cb17-121" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> size <span class="sc">*</span> p]</span>
<span id="cb17-122"><a href="#cb17-122" aria-hidden="true" tabindex="-1"></a>dt[, st.dev <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> size)]</span>
<span id="cb17-123"><a href="#cb17-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-124"><a href="#cb17-124" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb17-125"><a href="#cb17-125" aria-hidden="true" tabindex="-1"></a>dt[, Normal <span class="sc">:</span><span class="er">=</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>mu, <span class="at">sd =</span> st.dev) <span class="sc">*</span> <span class="dv">100</span>]</span>
<span id="cb17-126"><a href="#cb17-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-127"><a href="#cb17-127" aria-hidden="true" tabindex="-1"></a><span class="co"># convert to ordered factor</span></span>
<span id="cb17-128"><a href="#cb17-128" aria-hidden="true" tabindex="-1"></a>dt[, label <span class="sc">:</span><span class="er">=</span> <span class="fu">factor</span>(label, <span class="at">levels=</span><span class="fu">c</span>(<span class="st">"Prob: 5%, exp. successes 2 exp. failures 48"</span>,</span>
<span id="cb17-129"><a href="#cb17-129" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 30%, exp. successes 15 exp. failures 35"</span>,</span>
<span id="cb17-130"><a href="#cb17-130" aria-hidden="true" tabindex="-1"></a>                                     <span class="st">"Prob: 90%, exp. successes 45 exp. failures 5"</span> ))]</span>
<span id="cb17-131"><a href="#cb17-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-132"><a href="#cb17-132" aria-hidden="true" tabindex="-1"></a><span class="co"># reshape for plotting</span></span>
<span id="cb17-133"><a href="#cb17-133" aria-hidden="true" tabindex="-1"></a>dt.plot <span class="ot">&lt;-</span> <span class="fu">melt</span>(dt, <span class="at">id.vars =</span> <span class="fu">c</span>(<span class="st">"x"</span>, <span class="st">"label"</span>),</span>
<span id="cb17-134"><a href="#cb17-134" aria-hidden="true" tabindex="-1"></a>                <span class="at">measure.vars =</span> <span class="fu">c</span>(<span class="st">"Binomial"</span>, <span class="st">"Normal"</span>),</span>
<span id="cb17-135"><a href="#cb17-135" aria-hidden="true" tabindex="-1"></a>                <span class="at">variable.name =</span> <span class="fu">c</span>(<span class="st">"Type"</span>),</span>
<span id="cb17-136"><a href="#cb17-136" aria-hidden="true" tabindex="-1"></a>                <span class="at">value.name =</span> <span class="fu">c</span>(<span class="st">'prob'</span>))</span>
<span id="cb17-137"><a href="#cb17-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-138"><a href="#cb17-138" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb17-139"><a href="#cb17-139" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt.plot, <span class="fu">aes</span>(x, prob, <span class="at">color=</span>Type)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Probability, %"</span>)</span>
<span id="cb17-140"><a href="#cb17-140" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb17-141"><a href="#cb17-141" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-142"><a href="#cb17-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="fu">## error (R)</span></span>
<span id="cb17-144"><a href="#cb17-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-147"><a href="#cb17-147" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-148"><a href="#cb17-148" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use data.table from previous code chunk)</span></span>
<span id="cb17-149"><a href="#cb17-149" aria-hidden="true" tabindex="-1"></a>dt[, Error <span class="sc">:</span><span class="er">=</span> Binomial <span class="sc">-</span> Normal]</span>
<span id="cb17-150"><a href="#cb17-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-151"><a href="#cb17-151" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb17-152"><a href="#cb17-152" aria-hidden="true" tabindex="-1"></a>fig <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(dt, <span class="fu">aes</span>(x, Error)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>label, <span class="at">ncol =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="fu">ylab</span>(<span class="st">"Error (binom. - norm.), %"</span>)</span>
<span id="cb17-153"><a href="#cb17-153" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb17-154"><a href="#cb17-154" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-155"><a href="#cb17-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-156"><a href="#cb17-156" aria-hidden="true" tabindex="-1"></a><span class="fu">## binomial vs. normal (Python)</span></span>
<span id="cb17-157"><a href="#cb17-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-160"><a href="#cb17-160" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-161"><a href="#cb17-161" aria-hidden="true" tabindex="-1"></a><span class="co"># probabilities</span></span>
<span id="cb17-162"><a href="#cb17-162" aria-hidden="true" tabindex="-1"></a>p <span class="op">=</span> [<span class="fl">0.05</span>, <span class="fl">0.3</span>, <span class="fl">0.9</span>]</span>
<span id="cb17-163"><a href="#cb17-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-164"><a href="#cb17-164" aria-hidden="true" tabindex="-1"></a><span class="co"># successes</span></span>
<span id="cb17-165"><a href="#cb17-165" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">51</span>)</span>
<span id="cb17-166"><a href="#cb17-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-167"><a href="#cb17-167" aria-hidden="true" tabindex="-1"></a><span class="co"># create DataFrame with all combinations</span></span>
<span id="cb17-168"><a href="#cb17-168" aria-hidden="true" tabindex="-1"></a>df_1 <span class="op">=</span> pd.DataFrame({<span class="st">'p'</span>: p})</span>
<span id="cb17-169"><a href="#cb17-169" aria-hidden="true" tabindex="-1"></a>df_2 <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x})</span>
<span id="cb17-170"><a href="#cb17-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-171"><a href="#cb17-171" aria-hidden="true" tabindex="-1"></a><span class="co"># create key for joining</span></span>
<span id="cb17-172"><a href="#cb17-172" aria-hidden="true" tabindex="-1"></a>df_1[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-173"><a href="#cb17-173" aria-hidden="true" tabindex="-1"></a>df_2[<span class="st">'key'</span>] <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb17-174"><a href="#cb17-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-175"><a href="#cb17-175" aria-hidden="true" tabindex="-1"></a><span class="co"># perform cross join</span></span>
<span id="cb17-176"><a href="#cb17-176" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> df_1.merge(df_2, on<span class="op">=</span><span class="st">'key'</span>, how<span class="op">=</span><span class="st">'outer'</span>)</span>
<span id="cb17-177"><a href="#cb17-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-178"><a href="#cb17-178" aria-hidden="true" tabindex="-1"></a><span class="co"># drop key column</span></span>
<span id="cb17-179"><a href="#cb17-179" aria-hidden="true" tabindex="-1"></a><span class="kw">del</span> df[<span class="st">'key'</span>]</span>
<span id="cb17-180"><a href="#cb17-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-181"><a href="#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="co"># add size value</span></span>
<span id="cb17-182"><a href="#cb17-182" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'size'</span>] <span class="op">=</span> <span class="dv">50</span></span>
<span id="cb17-183"><a href="#cb17-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-184"><a href="#cb17-184" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate binomial probability</span></span>
<span id="cb17-185"><a href="#cb17-185" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Binomial'</span>] <span class="op">=</span> binom.pmf(df[<span class="st">'x'</span>], df[<span class="st">'size'</span>], df[<span class="st">'p'</span>]) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-186"><a href="#cb17-186" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb17-187"><a href="#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate mean and standard deviation</span></span>
<span id="cb17-188"><a href="#cb17-188" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'mu'</span>] <span class="op">=</span> df[<span class="st">'size'</span>] <span class="op">*</span> df[<span class="st">'p'</span>]</span>
<span id="cb17-189"><a href="#cb17-189" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'se'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">/</span> df[<span class="st">'size'</span>])</span>
<span id="cb17-190"><a href="#cb17-190" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'std'</span>] <span class="op">=</span> np.sqrt(df[<span class="st">'p'</span>] <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> df[<span class="st">'p'</span>]) <span class="op">*</span> df[<span class="st">'size'</span>])</span>
<span id="cb17-191"><a href="#cb17-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-192"><a href="#cb17-192" aria-hidden="true" tabindex="-1"></a><span class="co"># get norm distribution</span></span>
<span id="cb17-193"><a href="#cb17-193" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Normal'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: norm.pdf(x[<span class="st">'x'</span>], x[<span class="st">'mu'</span>], x[<span class="st">'std'</span>]) <span class="op">*</span> <span class="dv">100</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-194"><a href="#cb17-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-195"><a href="#cb17-195" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb17-196"><a href="#cb17-196" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-197"><a href="#cb17-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-198"><a href="#cb17-198" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb17-199"><a href="#cb17-199" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb17-200"><a href="#cb17-200" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb17-201"><a href="#cb17-201" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p].copy()</span>
<span id="cb17-202"><a href="#cb17-202" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-203"><a href="#cb17-203" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb17-204"><a href="#cb17-204" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Binomial'</span>], <span class="st">"o"</span>, label<span class="op">=</span><span class="st">'Binomial'</span>)<span class="op">;</span></span>
<span id="cb17-205"><a href="#cb17-205" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Normal'</span>], <span class="st">"-"</span>, label<span class="op">=</span><span class="st">'Normal'</span>, linewidth<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb17-206"><a href="#cb17-206" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-207"><a href="#cb17-207" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb17-208"><a href="#cb17-208" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb17-209"><a href="#cb17-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-210"><a href="#cb17-210" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb17-211"><a href="#cb17-211" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)<span class="op">;</span></span>
<span id="cb17-212"><a href="#cb17-212" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb17-213"><a href="#cb17-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-214"><a href="#cb17-214" aria-hidden="true" tabindex="-1"></a><span class="co"># add legend and white background</span></span>
<span id="cb17-215"><a href="#cb17-215" aria-hidden="true" tabindex="-1"></a>legend <span class="op">=</span> ax[<span class="dv">1</span>].legend(frameon <span class="op">=</span> <span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb17-216"><a href="#cb17-216" aria-hidden="true" tabindex="-1"></a>frame <span class="op">=</span> legend.get_frame()<span class="op">;</span></span>
<span id="cb17-217"><a href="#cb17-217" aria-hidden="true" tabindex="-1"></a>frame.set_color(<span class="st">'white'</span>)<span class="op">;</span></span>
<span id="cb17-218"><a href="#cb17-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-219"><a href="#cb17-219" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-220"><a href="#cb17-220" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-221"><a href="#cb17-221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-222"><a href="#cb17-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-223"><a href="#cb17-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## error (Python)</span></span>
<span id="cb17-224"><a href="#cb17-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-227"><a href="#cb17-227" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-228"><a href="#cb17-228" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate error (use DataFrame from previous code chunk)</span></span>
<span id="cb17-229"><a href="#cb17-229" aria-hidden="true" tabindex="-1"></a>df[<span class="st">'Error'</span>] <span class="op">=</span> df.Binomial <span class="op">-</span> df.Normal</span>
<span id="cb17-230"><a href="#cb17-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-231"><a href="#cb17-231" aria-hidden="true" tabindex="-1"></a><span class="co"># create figure</span></span>
<span id="cb17-232"><a href="#cb17-232" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">3</span>, <span class="dv">1</span>, sharey<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb17-233"><a href="#cb17-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-234"><a href="#cb17-234" aria-hidden="true" tabindex="-1"></a><span class="co"># iterate over probabilities</span></span>
<span id="cb17-235"><a href="#cb17-235" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i, _p <span class="kw">in</span> <span class="bu">enumerate</span>(p):</span>
<span id="cb17-236"><a href="#cb17-236" aria-hidden="true" tabindex="-1"></a>  <span class="co"># select data for plotting</span></span>
<span id="cb17-237"><a href="#cb17-237" aria-hidden="true" tabindex="-1"></a>  dt_plot <span class="op">=</span> df.loc[df[<span class="st">'p'</span>] <span class="op">==</span> _p]</span>
<span id="cb17-238"><a href="#cb17-238" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-239"><a href="#cb17-239" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot binomial and normal distributions</span></span>
<span id="cb17-240"><a href="#cb17-240" aria-hidden="true" tabindex="-1"></a>  ax[i].plot(dt_plot[<span class="st">'x'</span>], dt_plot[<span class="st">'Error'</span>], <span class="st">"o"</span>, color<span class="op">=</span><span class="st">'k'</span>, markersize<span class="op">=</span><span class="dv">3</span>)<span class="op">;</span></span>
<span id="cb17-241"><a href="#cb17-241" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-242"><a href="#cb17-242" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add sub titles</span></span>
<span id="cb17-243"><a href="#cb17-243" aria-hidden="true" tabindex="-1"></a>  ax[i].set_title(<span class="ss">f"Prob. </span><span class="sc">{</span>_p<span class="op">*</span><span class="dv">100</span><span class="sc">:.0f}</span><span class="ss">% expected </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>_p<span class="sc">:.0f}</span><span class="ss"> successes and </span><span class="sc">{</span><span class="dv">50</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>_p)<span class="sc">:.0f}</span><span class="ss"> failures"</span>, fontsize<span class="op">=</span><span class="dv">8</span>)<span class="op">;</span></span>
<span id="cb17-244"><a href="#cb17-244" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-245"><a href="#cb17-245" aria-hidden="true" tabindex="-1"></a><span class="co"># adjust limits for better readability</span></span>
<span id="cb17-246"><a href="#cb17-246" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="fl">4.9</span>, <span class="fl">4.9</span>)</span>
<span id="cb17-247"><a href="#cb17-247" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-248"><a href="#cb17-248" aria-hidden="true" tabindex="-1"></a><span class="co"># add labels</span></span>
<span id="cb17-249"><a href="#cb17-249" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_ylabel(<span class="st">"Probability, %"</span>)</span>
<span id="cb17-250"><a href="#cb17-250" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_xlabel(<span class="st">"x"</span>)</span>
<span id="cb17-251"><a href="#cb17-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-252"><a href="#cb17-252" aria-hidden="true" tabindex="-1"></a>plt.tight_layout()</span>
<span id="cb17-253"><a href="#cb17-253" aria-hidden="true" tabindex="-1"></a>plt.show()</span>
<span id="cb17-254"><a href="#cb17-254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-255"><a href="#cb17-255" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-256"><a href="#cb17-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-257"><a href="#cb17-257" aria-hidden="true" tabindex="-1"></a>The first thing to notice is that the "Success-Failure" criterion is only met for the p=30% case. In tabs <span class="in">`error`</span> one can see that approximation error, i.e. the difference between Binomial probability and Normal distribution approximations, is above 2% for the $p=5\%$ and $p=90\%$ examples.</span>
<span id="cb17-258"><a href="#cb17-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-259"><a href="#cb17-259" aria-hidden="true" tabindex="-1"></a><span class="fu">## Estimating approximation error</span></span>
<span id="cb17-260"><a href="#cb17-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-261"><a href="#cb17-261" aria-hidden="true" tabindex="-1"></a>There are a different way to calculate approximation error dependence on sample size. Let's establish 3 types of probabilities:</span>
<span id="cb17-262"><a href="#cb17-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-263"><a href="#cb17-263" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$p_1$ we would observe more than expected number of occurrences,</span>
<span id="cb17-264"><a href="#cb17-264" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$p_2$ we would observe expected number of occurrences,</span>
<span id="cb17-265"><a href="#cb17-265" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>$p_3$ we would observe less than expected number of occurrences.</span>
<span id="cb17-266"><a href="#cb17-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-267"><a href="#cb17-267" aria-hidden="true" tabindex="-1"></a>We have to be mindful, when comparing discrete binomial distribution with a continuous normal distribution. In examples bellow, we can compare areas under the curve for both distributions using interactive charts by <span class="in">`plotly`</span> library/package. First I create a function to visualize both pint cand cumulative probabilities using interactive charts.</span>
<span id="cb17-268"><a href="#cb17-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-269"><a href="#cb17-269" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-270"><a href="#cb17-270" aria-hidden="true" tabindex="-1"></a><span class="fu">## plot_ly function (R)</span></span>
<span id="cb17-271"><a href="#cb17-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-274"><a href="#cb17-274" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-275"><a href="#cb17-275" aria-hidden="true" tabindex="-1"></a>PlotDistributions <span class="ot">&lt;-</span> <span class="cf">function</span>(prob, size){</span>
<span id="cb17-276"><a href="#cb17-276" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb17-277"><a href="#cb17-277" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span>(size<span class="sc">*</span>prob<span class="sc">*</span><span class="dv">3</span>)</span>
<span id="cb17-278"><a href="#cb17-278" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-279"><a href="#cb17-279" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb17-280"><a href="#cb17-280" aria-hidden="true" tabindex="-1"></a>  y.binom <span class="ot">&lt;-</span> <span class="fu">dbinom</span>(x, <span class="at">size=</span>size, <span class="at">prob=</span>prob) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-281"><a href="#cb17-281" aria-hidden="true" tabindex="-1"></a>  y.norm <span class="ot">&lt;-</span> <span class="fu">dnorm</span>(x, <span class="at">mean=</span>size <span class="sc">*</span> prob, <span class="at">sd =</span> <span class="fu">sqrt</span>(prob <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> prob) <span class="sc">*</span> size)) <span class="sc">*</span> <span class="dv">100</span></span>
<span id="cb17-282"><a href="#cb17-282" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-283"><a href="#cb17-283" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create data table for plotting</span></span>
<span id="cb17-284"><a href="#cb17-284" aria-hidden="true" tabindex="-1"></a>  dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">x =</span> x,</span>
<span id="cb17-285"><a href="#cb17-285" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.binom =</span> y.binom,</span>
<span id="cb17-286"><a href="#cb17-286" aria-hidden="true" tabindex="-1"></a>                   <span class="at">prob.norm =</span> y.norm)</span>
<span id="cb17-287"><a href="#cb17-287" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-288"><a href="#cb17-288" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add columns with hover information</span></span>
<span id="cb17-289"><a href="#cb17-289" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb17-290"><a href="#cb17-290" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb17-291"><a href="#cb17-291" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate probability&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb17-292"><a href="#cb17-292" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb17-293"><a href="#cb17-293" aria-hidden="true" tabindex="-1"></a>  dt[, text<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">paste0</span>(<span class="st">'Point estimate error&lt;br&gt;to observer exactly '</span>, x,</span>
<span id="cb17-294"><a href="#cb17-294" aria-hidden="true" tabindex="-1"></a>                        <span class="st">' events is '</span>, <span class="fu">round</span>(y.binom <span class="sc">-</span> y.norm, <span class="dv">3</span>), <span class="st">"%"</span>)]</span>
<span id="cb17-295"><a href="#cb17-295" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb17-296"><a href="#cb17-296" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> <span class="fu">plot_ly</span>(<span class="at">data =</span> dt, <span class="at">type =</span> <span class="st">'scatter'</span>, <span class="at">mode =</span> <span class="st">'lines'</span>)</span>
<span id="cb17-297"><a href="#cb17-297" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-298"><a href="#cb17-298" aria-hidden="true" tabindex="-1"></a>  <span class="co"># add traces</span></span>
<span id="cb17-299"><a href="#cb17-299" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.norm, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.1</span>,</span>
<span id="cb17-300"><a href="#cb17-300" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Normal'</span>,<span class="at">mode =</span> <span class="st">'lines'</span>,</span>
<span id="cb17-301"><a href="#cb17-301" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb17-302"><a href="#cb17-302" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#FF6666"</span>, <span class="at">width =</span> <span class="dv">5</span>))</span>
<span id="cb17-303"><a href="#cb17-303" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>prob.binom, <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.2</span>,</span>
<span id="cb17-304"><a href="#cb17-304" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Binomial'</span>,<span class="at">mode =</span> <span class="st">'markers'</span>,</span>
<span id="cb17-305"><a href="#cb17-305" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb17-306"><a href="#cb17-306" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"#3399FF"</span>, <span class="at">size =</span> <span class="dv">12</span>))</span>
<span id="cb17-307"><a href="#cb17-307" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">add_trace</span>(<span class="at">x =</span> <span class="sc">~</span>x, <span class="at">y =</span> <span class="sc">~</span>(prob.binom<span class="sc">-</span>prob.norm), <span class="at">text =</span> <span class="sc">~</span>text<span class="fl">.3</span>,</span>
<span id="cb17-308"><a href="#cb17-308" aria-hidden="true" tabindex="-1"></a>                           <span class="at">name =</span> <span class="st">'Error'</span>,<span class="at">mode =</span> <span class="st">'lines+markers'</span>,</span>
<span id="cb17-309"><a href="#cb17-309" aria-hidden="true" tabindex="-1"></a>                           <span class="at">hoverinfo =</span> <span class="st">'text'</span>,</span>
<span id="cb17-310"><a href="#cb17-310" aria-hidden="true" tabindex="-1"></a>                           <span class="at">line =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">width =</span> <span class="dv">5</span>),</span>
<span id="cb17-311"><a href="#cb17-311" aria-hidden="true" tabindex="-1"></a>                           <span class="at">marker =</span> <span class="fu">list</span>(<span class="at">color =</span> <span class="st">"black"</span>, <span class="at">size =</span> <span class="dv">12</span>),</span>
<span id="cb17-312"><a href="#cb17-312" aria-hidden="true" tabindex="-1"></a>                           <span class="at">visible =</span> <span class="st">"legendonly"</span>) </span>
<span id="cb17-313"><a href="#cb17-313" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-314"><a href="#cb17-314" aria-hidden="true" tabindex="-1"></a>  <span class="co"># update layout</span></span>
<span id="cb17-315"><a href="#cb17-315" aria-hidden="true" tabindex="-1"></a>  fig <span class="ot">&lt;-</span> fig <span class="sc">%&gt;%</span> <span class="fu">layout</span>(<span class="at">title =</span> <span class="fu">paste0</span>(<span class="st">"p = "</span>, <span class="fu">round</span>(prob<span class="sc">*</span><span class="dv">100</span>), <span class="st">"%, "</span>, size, <span class="st">" trials"</span>),</span>
<span id="cb17-316"><a href="#cb17-316" aria-hidden="true" tabindex="-1"></a>                        <span class="at">xaxis =</span> <span class="fu">list</span>(<span class="at">title =</span> <span class="st">"Observations"</span>),</span>
<span id="cb17-317"><a href="#cb17-317" aria-hidden="true" tabindex="-1"></a>                        <span class="at">yaxis =</span> <span class="fu">list</span> (<span class="at">title =</span> <span class="st">"Probability, %"</span>),</span>
<span id="cb17-318"><a href="#cb17-318" aria-hidden="true" tabindex="-1"></a>                        <span class="at">hovermode =</span> <span class="st">"x unified"</span>,</span>
<span id="cb17-319"><a href="#cb17-319" aria-hidden="true" tabindex="-1"></a>                        <span class="at">legend=</span><span class="fu">list</span>(<span class="at">title=</span><span class="fu">list</span>(<span class="at">text=</span><span class="st">'&lt;b&gt; Distributions &lt;/b&gt;'</span>)))</span>
<span id="cb17-320"><a href="#cb17-320" aria-hidden="true" tabindex="-1"></a>  <span class="co"># return figure</span></span>
<span id="cb17-321"><a href="#cb17-321" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(fig)</span>
<span id="cb17-322"><a href="#cb17-322" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb17-323"><a href="#cb17-323" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-324"><a href="#cb17-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-325"><a href="#cb17-325" aria-hidden="true" tabindex="-1"></a><span class="fu">## plotly function (Python)</span></span>
<span id="cb17-326"><a href="#cb17-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-329"><a href="#cb17-329" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-330"><a href="#cb17-330" aria-hidden="true" tabindex="-1"></a><span class="co"># create function for plotting distributions</span></span>
<span id="cb17-331"><a href="#cb17-331" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plot_distributions(prob, size):</span>
<span id="cb17-332"><a href="#cb17-332" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create observation vector</span></span>
<span id="cb17-333"><a href="#cb17-333" aria-hidden="true" tabindex="-1"></a>  x <span class="op">=</span> np.arange(<span class="bu">int</span>(size<span class="op">*</span>prob<span class="op">*</span><span class="dv">3</span>))</span>
<span id="cb17-334"><a href="#cb17-334" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-335"><a href="#cb17-335" aria-hidden="true" tabindex="-1"></a>  <span class="co"># get probabilities for both binomial and norm distributions</span></span>
<span id="cb17-336"><a href="#cb17-336" aria-hidden="true" tabindex="-1"></a>  y_binom <span class="op">=</span> binom.pmf(x, n<span class="op">=</span>size, p<span class="op">=</span>prob) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-337"><a href="#cb17-337" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-338"><a href="#cb17-338" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate variance and sigma</span></span>
<span id="cb17-339"><a href="#cb17-339" aria-hidden="true" tabindex="-1"></a>  variance <span class="op">=</span> size <span class="op">*</span> prob <span class="op">*</span> (<span class="dv">1</span> <span class="op">-</span> prob)</span>
<span id="cb17-340"><a href="#cb17-340" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> np.sqrt(variance)</span>
<span id="cb17-341"><a href="#cb17-341" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-342"><a href="#cb17-342" aria-hidden="true" tabindex="-1"></a>  y_norm <span class="op">=</span> norm.pdf(x, loc <span class="op">=</span> size <span class="op">*</span> prob, scale <span class="op">=</span> sigma) <span class="op">*</span> <span class="dv">100</span></span>
<span id="cb17-343"><a href="#cb17-343" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-344"><a href="#cb17-344" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate Data.Frame</span></span>
<span id="cb17-345"><a href="#cb17-345" aria-hidden="true" tabindex="-1"></a>  df <span class="op">=</span> pd.DataFrame({<span class="st">'x'</span>: x, <span class="st">'binom'</span>: y_binom, <span class="st">'norm'</span>: y_norm})</span>
<span id="cb17-346"><a href="#cb17-346" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-347"><a href="#cb17-347" aria-hidden="true" tabindex="-1"></a>  <span class="co"># calculate error</span></span>
<span id="cb17-348"><a href="#cb17-348" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'error'</span>] <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb17-349"><a href="#cb17-349" aria-hidden="true" tabindex="-1"></a>  error <span class="op">=</span> df.binom <span class="op">-</span> df.norm</span>
<span id="cb17-350"><a href="#cb17-350" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-351"><a href="#cb17-351" aria-hidden="true" tabindex="-1"></a>  <span class="co"># generate hover messages</span></span>
<span id="cb17-352"><a href="#cb17-352" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_1'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"binom"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-353"><a href="#cb17-353" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_2'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate probability&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"norm"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-354"><a href="#cb17-354" aria-hidden="true" tabindex="-1"></a>  df[<span class="st">'text_3'</span>] <span class="op">=</span> df.<span class="bu">apply</span>(<span class="kw">lambda</span> x: <span class="ss">f'Point estimate error&lt;br&gt;to observer exactly </span><span class="sc">{</span>x[<span class="st">"x"</span>]<span class="sc">:.0f}</span><span class="ss"> events is </span><span class="sc">{</span>x[<span class="st">"error"</span>]<span class="sc">:.3f}</span><span class="ss">%'</span>, axis <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb17-355"><a href="#cb17-355" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb17-356"><a href="#cb17-356" aria-hidden="true" tabindex="-1"></a>  <span class="co"># create figure</span></span>
<span id="cb17-357"><a href="#cb17-357" aria-hidden="true" tabindex="-1"></a>  fig <span class="op">=</span> go.Figure()</span>
<span id="cb17-358"><a href="#cb17-358" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_norm, text <span class="op">=</span> df[<span class="st">'text_1'</span>].values,</span>
<span id="cb17-359"><a href="#cb17-359" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'lines'</span>, name<span class="op">=</span><span class="st">'Normal'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb17-360"><a href="#cb17-360" aria-hidden="true" tabindex="-1"></a>                           line<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#FF6666'</span>, width<span class="op">=</span><span class="dv">5</span>)))</span>
<span id="cb17-361"><a href="#cb17-361" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>y_binom, text <span class="op">=</span> df[<span class="st">'text_2'</span>].values,</span>
<span id="cb17-362"><a href="#cb17-362" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Binomial'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb17-363"><a href="#cb17-363" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'#3399FF'</span>, size<span class="op">=</span><span class="dv">12</span>)))</span>
<span id="cb17-364"><a href="#cb17-364" aria-hidden="true" tabindex="-1"></a>  fig.add_trace(go.Scatter(x<span class="op">=</span>x, y<span class="op">=</span>error, text <span class="op">=</span> df[<span class="st">'text_3'</span>].values,</span>
<span id="cb17-365"><a href="#cb17-365" aria-hidden="true" tabindex="-1"></a>                           mode<span class="op">=</span><span class="st">'markers'</span>, name<span class="op">=</span><span class="st">'Error'</span>, hoverinfo <span class="op">=</span> <span class="st">'text'</span>,</span>
<span id="cb17-366"><a href="#cb17-366" aria-hidden="true" tabindex="-1"></a>                           marker<span class="op">=</span><span class="bu">dict</span>(color<span class="op">=</span><span class="st">'black'</span>, size<span class="op">=</span><span class="dv">12</span>),</span>
<span id="cb17-367"><a href="#cb17-367" aria-hidden="true" tabindex="-1"></a>                           visible <span class="op">=</span> <span class="st">"legendonly"</span>))</span>
<span id="cb17-368"><a href="#cb17-368" aria-hidden="true" tabindex="-1"></a>                           </span>
<span id="cb17-369"><a href="#cb17-369" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Edit the layout</span></span>
<span id="cb17-370"><a href="#cb17-370" aria-hidden="true" tabindex="-1"></a>  fig.update_layout(title<span class="op">=</span><span class="ss">f"p = </span><span class="sc">{</span>prob<span class="op">*</span><span class="dv">100</span><span class="sc">:.1f}</span><span class="ss">%, </span><span class="sc">{</span>size<span class="sc">}</span><span class="ss"> trials"</span>,</span>
<span id="cb17-371"><a href="#cb17-371" aria-hidden="true" tabindex="-1"></a>                    xaxis_title<span class="op">=</span><span class="st">'Observations'</span>,</span>
<span id="cb17-372"><a href="#cb17-372" aria-hidden="true" tabindex="-1"></a>                    yaxis_title<span class="op">=</span><span class="st">'Probability, %'</span>,</span>
<span id="cb17-373"><a href="#cb17-373" aria-hidden="true" tabindex="-1"></a>                    template<span class="op">=</span><span class="st">"ggplot2"</span>,</span>
<span id="cb17-374"><a href="#cb17-374" aria-hidden="true" tabindex="-1"></a>                    hovermode<span class="op">=</span><span class="st">"x unified"</span>)</span>
<span id="cb17-375"><a href="#cb17-375" aria-hidden="true" tabindex="-1"></a>                   </span>
<span id="cb17-376"><a href="#cb17-376" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> fig</span>
<span id="cb17-377"><a href="#cb17-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-378"><a href="#cb17-378" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-379"><a href="#cb17-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-380"><a href="#cb17-380" aria-hidden="true" tabindex="-1"></a>Next I provide examples using different probabilities.</span>
<span id="cb17-381"><a href="#cb17-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-382"><a href="#cb17-382" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-383"><a href="#cb17-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-384"><a href="#cb17-384" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5% (R)</span></span>
<span id="cb17-385"><a href="#cb17-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-388"><a href="#cb17-388" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-389"><a href="#cb17-389" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb17-390"><a href="#cb17-390" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.05</span>, <span class="dv">200</span>)</span>
<span id="cb17-391"><a href="#cb17-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-392"><a href="#cb17-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-393"><a href="#cb17-393" aria-hidden="true" tabindex="-1"></a><span class="fu">## 1% (R)</span></span>
<span id="cb17-394"><a href="#cb17-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-397"><a href="#cb17-397" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-398"><a href="#cb17-398" aria-hidden="true" tabindex="-1"></a><span class="co"># return figure</span></span>
<span id="cb17-399"><a href="#cb17-399" aria-hidden="true" tabindex="-1"></a><span class="fu">PlotDistributions</span>(<span class="fl">0.01</span>, <span class="dv">500</span>)</span>
<span id="cb17-400"><a href="#cb17-400" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-401"><a href="#cb17-401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-402"><a href="#cb17-402" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0.5% (Python)</span></span>
<span id="cb17-403"><a href="#cb17-403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-406"><a href="#cb17-406" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-407"><a href="#cb17-407" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb17-408"><a href="#cb17-408" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.005</span>, <span class="dv">500</span>)</span>
<span id="cb17-409"><a href="#cb17-409" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb17-410"><a href="#cb17-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-411"><a href="#cb17-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-412"><a href="#cb17-412" aria-hidden="true" tabindex="-1"></a><span class="fu">## 0.0=1% (Python)</span></span>
<span id="cb17-413"><a href="#cb17-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-416"><a href="#cb17-416" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-417"><a href="#cb17-417" aria-hidden="true" tabindex="-1"></a><span class="co"># use python helper function from above</span></span>
<span id="cb17-418"><a href="#cb17-418" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plot_distributions(<span class="fl">0.001</span>, <span class="dv">2000</span>)</span>
<span id="cb17-419"><a href="#cb17-419" aria-hidden="true" tabindex="-1"></a>fig</span>
<span id="cb17-420"><a href="#cb17-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-421"><a href="#cb17-421" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-422"><a href="#cb17-422" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-423"><a href="#cb17-423" aria-hidden="true" tabindex="-1"></a>Let's taken hypothetical model of 1%, i.e. we expect to have 1% manufacturing defects or 1% of clients in our portfolio will fail to meet their credit obligations. For this hypothetical model to meet "Success-Failure" condition we would need to collect at least 1000 observations, i.e. to manufacture 1000 devices or issue credit to 1000 obligatory. Let's compare 3 probabilities calculated using binomial and normal distribution approximation:</span>
<span id="cb17-424"><a href="#cb17-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-425"><a href="#cb17-425" aria-hidden="true" tabindex="-1"></a>In all 3 cases, we need to calculated expected number of occurrences $n \cdot p$. Let's investigate sample sizes raging from 100 to 2000. </span>
<span id="cb17-426"><a href="#cb17-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-427"><a href="#cb17-427" aria-hidden="true" tabindex="-1"></a>From the given example, we can ratios between probabilities for all 3 cases.</span>
<span id="cb17-428"><a href="#cb17-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-429"><a href="#cb17-429" aria-hidden="true" tabindex="-1"></a>::: panel-tabset</span>
<span id="cb17-430"><a href="#cb17-430" aria-hidden="true" tabindex="-1"></a><span class="fu">## R</span></span>
<span id="cb17-431"><a href="#cb17-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-434"><a href="#cb17-434" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb17-435"><a href="#cb17-435" aria-hidden="true" tabindex="-1"></a><span class="co"># create vector with different sample sizes</span></span>
<span id="cb17-436"><a href="#cb17-436" aria-hidden="true" tabindex="-1"></a>sampleSizes <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">2000</span>, <span class="dv">100</span>)</span>
<span id="cb17-437"><a href="#cb17-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-438"><a href="#cb17-438" aria-hidden="true" tabindex="-1"></a><span class="co"># create data.table for p = 0.01, i.e. 1%</span></span>
<span id="cb17-439"><a href="#cb17-439" aria-hidden="true" tabindex="-1"></a>dt <span class="ot">&lt;-</span> <span class="fu">data.table</span>(<span class="at">N =</span> sampleSizes, <span class="at">p =</span> <span class="fl">0.02</span>)</span>
<span id="cb17-440"><a href="#cb17-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-441"><a href="#cb17-441" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate expected number of observations and standard deviation</span></span>
<span id="cb17-442"><a href="#cb17-442" aria-hidden="true" tabindex="-1"></a>dt[, mu <span class="sc">:</span><span class="er">=</span> N <span class="sc">*</span> p]</span>
<span id="cb17-443"><a href="#cb17-443" aria-hidden="true" tabindex="-1"></a>dt[, std <span class="sc">:</span><span class="er">=</span> <span class="fu">sqrt</span>(p <span class="sc">*</span> (<span class="dv">1</span> <span class="sc">-</span> p) <span class="sc">*</span> N)]</span>
<span id="cb17-444"><a href="#cb17-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-445"><a href="#cb17-445" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate probabilities of observing:</span></span>
<span id="cb17-446"><a href="#cb17-446" aria-hidden="true" tabindex="-1"></a><span class="co"># 1. less than the expected number of observations</span></span>
<span id="cb17-447"><a href="#cb17-447" aria-hidden="true" tabindex="-1"></a><span class="co"># 2. exactly the expected number of observations</span></span>
<span id="cb17-448"><a href="#cb17-448" aria-hidden="true" tabindex="-1"></a><span class="co"># 3. more than the expected number of observations</span></span>
<span id="cb17-449"><a href="#cb17-449" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pbinom</span>(mu<span class="dv">-1</span>, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb17-450"><a href="#cb17-450" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">dbinom</span>(mu, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb17-451"><a href="#cb17-451" aria-hidden="true" tabindex="-1"></a>dt[, binom<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pbinom</span>(mu, <span class="at">size=</span>N, <span class="at">prob=</span>p)]</span>
<span id="cb17-452"><a href="#cb17-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-453"><a href="#cb17-453" aria-hidden="true" tabindex="-1"></a><span class="co"># same but for normal distribution</span></span>
<span id="cb17-454"><a href="#cb17-454" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.1</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pnorm</span>(mu<span class="dv">-1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb17-455"><a href="#cb17-455" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.2</span> <span class="sc">:</span><span class="er">=</span> <span class="fu">pnorm</span>(mu<span class="sc">+</span><span class="dv">1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std) <span class="sc">-</span> <span class="fu">pnorm</span>(mu<span class="dv">-1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb17-456"><a href="#cb17-456" aria-hidden="true" tabindex="-1"></a>dt[, norm<span class="fl">.3</span> <span class="sc">:</span><span class="er">=</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">pnorm</span>(mu<span class="sc">+</span><span class="dv">1</span>, <span class="at">mean =</span> mu, <span class="at">sd =</span> std)]</span>
<span id="cb17-457"><a href="#cb17-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-458"><a href="#cb17-458" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate errors</span></span>
<span id="cb17-459"><a href="#cb17-459" aria-hidden="true" tabindex="-1"></a>dt[, error.left <span class="sc">:</span><span class="er">=</span> binom<span class="fl">.1</span><span class="sc">/</span>norm<span class="fl">.1</span>]</span>
<span id="cb17-460"><a href="#cb17-460" aria-hidden="true" tabindex="-1"></a>dt[, error.right <span class="sc">:</span><span class="er">=</span> binom<span class="fl">.3</span><span class="sc">/</span>norm<span class="fl">.3</span>]</span>
<span id="cb17-461"><a href="#cb17-461" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-462"><a href="#cb17-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-463"><a href="#cb17-463" aria-hidden="true" tabindex="-1"></a><span class="fu">## Python</span></span>
<span id="cb17-464"><a href="#cb17-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-467"><a href="#cb17-467" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb17-468"><a href="#cb17-468" aria-hidden="true" tabindex="-1"></a><span class="co"># load packages for blog post</span></span>
<span id="cb17-469"><a href="#cb17-469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-470"><a href="#cb17-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb17-471"><a href="#cb17-471" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb17-472"><a href="#cb17-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-473"><a href="#cb17-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## Independent observations</span></span>
<span id="cb17-474"><a href="#cb17-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-475"><a href="#cb17-475" aria-hidden="true" tabindex="-1"></a><span class="fu">## References</span></span>
<span id="cb17-476"><a href="#cb17-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-477"><a href="#cb17-477" aria-hidden="true" tabindex="-1"></a>Content for this blog post was prepared using following references:</span>
<span id="cb17-478"><a href="#cb17-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-479"><a href="#cb17-479" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://statistics.laerd.com/spss-tutorials/binomial-test-using-spss-statistics.php</span>
<span id="cb17-480"><a href="#cb17-480" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>http://mlwiki.org/index.php/Binomial_Proportion_Tests</span>
<span id="cb17-481"><a href="#cb17-481" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://sites.ualberta.ca/\~lkgray/uploads/7/3/6/2/7362679/slides\_-\_binomialproportionaltests.pdf</span>
<span id="cb17-482"><a href="#cb17-482" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.technologynetworks.com/informatics/articles/the-binomial-test-366022</span>
<span id="cb17-483"><a href="#cb17-483" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://towardsdatascience.com/turning-a-two-sample-event-rate-test-into-a-one-sample-binomial-test-23fbfb9d1df6</span>
<span id="cb17-484"><a href="#cb17-484" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.studysmarter.us/explanations/math/statistics/binomial-hypothesis-test/</span>
<span id="cb17-485"><a href="#cb17-485" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://www.statology.org/success-failure-condition/</span>
<span id="cb17-486"><a href="#cb17-486" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://towardsdatascience.com/bernoulli-and-binomial-random-variables-d0698288dd36</span>
<span id="cb17-487"><a href="#cb17-487" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://ubc-mds.github.io/DSCI_551_stat-prob-dsci/lectures/simulation.html</span>
<span id="cb17-488"><a href="#cb17-488" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>https://math.stackexchange.com/questions/1978138/probability-of-x-red-balls-when-drawing-y-balls-from-a-red-and-b-green-balls</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>